(()=>{"use strict";var t={420:(t,e,n)=>{n.d(e,{A:()=>h});var r=n(601),o=n.n(r),i=n(314),a=n.n(i),l=n(417),c=n.n(l),u=new URL(n(474),n.b),s=a()(o()),f=c()(u);s.push([t.id,`body {\n  margin: 0;\n}\n.x-spreadsheet {\n  font-size: 13px;\n  line-height: normal;\n  user-select: none;\n  -moz-user-select: none;\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  box-sizing: content-box;\n  background: #fff;\n  -webkit-font-smoothing: antialiased;\n}\n.x-spreadsheet textarea {\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n}\n.x-spreadsheet-sheet {\n  position: relative;\n  overflow: hidden;\n}\n.x-spreadsheet-table {\n  vertical-align: bottom;\n}\n.x-spreadsheet-tooltip {\n  font-family: inherit;\n  position: absolute;\n  padding: 5px 10px;\n  color: #fff;\n  border-radius: 1px;\n  background: #000000;\n  font-size: 12px;\n  z-index: 201;\n}\n.x-spreadsheet-tooltip:before {\n  pointer-events: none;\n  position: absolute;\n  left: calc(50% - 4px);\n  top: -4px;\n  content: "";\n  width: 8px;\n  height: 8px;\n  background: inherit;\n  -webkit-transform: rotate(45deg);\n  transform: rotate(45deg);\n  z-index: 1;\n  box-shadow: 1px 1px 3px -1px rgba(0, 0, 0, 0.3);\n}\n.x-spreadsheet-color-palette {\n  padding: 5px;\n}\n.x-spreadsheet-color-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 2;\n  background: #fff;\n}\n.x-spreadsheet-color-palette table td {\n  margin: 0;\n  cursor: pointer;\n  border: 1px solid transparent;\n}\n.x-spreadsheet-color-palette table td:hover {\n  border-color: #ddd;\n}\n.x-spreadsheet-color-palette table td .x-spreadsheet-color-palette-cell {\n  width: 16px;\n  height: 16px;\n}\n.x-spreadsheet-border-palette {\n  padding: 6px;\n}\n.x-spreadsheet-border-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 0;\n  background: #fff;\n  table-layout: fixed;\n}\n.x-spreadsheet-border-palette table td {\n  margin: 0;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left {\n  border-right: 1px solid #eee;\n  padding-right: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell {\n  width: 30px;\n  height: 30px;\n  cursor: pointer;\n  text-align: center;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell .x-spreadsheet-icon-img {\n  opacity: 0.8;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell:hover {\n  background-color: #eee;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right {\n  padding-left: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-toolbar-btn {\n  margin-top: 0;\n  margin-bottom: 3px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-line-type {\n  position: relative;\n  left: 0;\n  top: -3px;\n}\n.x-spreadsheet-dropdown {\n  position: relative;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-content {\n  position: absolute;\n  z-index: 200;\n  background: #fff;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n}\n.x-spreadsheet-dropdown.bottom-left .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.bottom-right .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown.top-left .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.top-right .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-title {\n  padding: 0 5px;\n  display: inline-block;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-left {\n  margin-left: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right {\n  width: 10px;\n  margin-right: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right .arrow-down {\n  left: -130px;\n}\n/* resizer **/\n.x-spreadsheet-resizer {\n  position: absolute;\n  z-index: 11;\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-hover {\n  background-color: rgba(75, 137, 255, 0.25);\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-line {\n  position: absolute;\n}\n.x-spreadsheet-resizer.horizontal {\n  cursor: row-resize;\n}\n.x-spreadsheet-resizer.horizontal .x-spreadsheet-resizer-line {\n  border-bottom: 2px dashed #4b89ff;\n  left: 0;\n  bottom: 0;\n}\n.x-spreadsheet-resizer.vertical {\n  cursor: col-resize;\n}\n.x-spreadsheet-resizer.vertical .x-spreadsheet-resizer-line {\n  border-right: 2px dashed #4b89ff;\n  top: 0;\n  right: 0;\n}\n/* scrollbar */\n.x-spreadsheet-scrollbar {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background-color: #f4f5f8;\n  opacity: 0.9;\n  z-index: 12;\n}\n.x-spreadsheet-scrollbar.horizontal {\n  right: 15px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n}\n.x-spreadsheet-scrollbar.horizontal > div {\n  height: 1px;\n  background: #ddd;\n}\n.x-spreadsheet-scrollbar.vertical {\n  bottom: 15px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.x-spreadsheet-scrollbar.vertical > div {\n  width: 1px;\n  background: #ddd;\n}\n/* @{css-prefix}-overlayer */\n.x-spreadsheet-overlayer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 10;\n}\n.x-spreadsheet-overlayer .x-spreadsheet-overlayer-content {\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n}\n.x-spreadsheet-editor,\n.x-spreadsheet-selector {\n  box-sizing: content-box;\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n/* @{css-prefix}-selector */\n.x-spreadsheet-selector .hide-input {\n  position: absolute;\n  z-index: 0;\n}\n.x-spreadsheet-selector .hide-input input {\n  padding: 0;\n  width: 0;\n  border: none!important;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-area {\n  position: absolute;\n  border: 2px solid #4b89ff;\n  background: rgba(75, 137, 255, 0.1);\n  z-index: 5;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard,\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  position: absolute;\n  background: transparent;\n  z-index: 100;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard {\n  border: 2px dashed #4b89ff;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  border: 1px dashed rgba(0, 0, 0, 0.45);\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-corner {\n  pointer-events: auto;\n  position: absolute;\n  cursor: crosshair;\n  font-size: 0;\n  height: 5px;\n  width: 5px;\n  right: -5px;\n  bottom: -5px;\n  border: 2px solid #ffffff;\n  background: #4b89ff;\n}\n.x-spreadsheet-editor {\n  z-index: 20;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area {\n  position: absolute;\n  text-align: left;\n  border: 2px solid #4b89ff;\n  line-height: 0;\n  z-index: 100;\n  pointer-events: auto;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area textarea {\n  box-sizing: content-box;\n  border: none;\n  padding: 0 3px;\n  outline: none;\n  resize: none;\n  text-align: start;\n  overflow-y: hidden;\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n  color: inherit;\n  white-space: normal;\n  word-wrap: break-word;\n  line-height: 22px;\n  margin: 0;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area .textline {\n  overflow: hidden;\n  visibility: hidden;\n  position: fixed;\n  top: 0;\n  left: 0;\n}\n.x-spreadsheet-item {\n  user-select: none;\n  background: 0;\n  border: 1px solid transparent;\n  outline: none;\n  height: 26px;\n  color: rgba(0, 0, 0, 0.9);\n  line-height: 26px;\n  list-style: none;\n  padding: 2px 10px;\n  cursor: default;\n  text-align: left;\n  overflow: hidden;\n}\n.x-spreadsheet-item.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-item:hover,\n.x-spreadsheet-item.active {\n  background: rgba(0, 0, 0, 0.05);\n}\n.x-spreadsheet-item.divider {\n  height: 0;\n  padding: 0;\n  margin: 5px 0;\n  border: none;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n}\n.x-spreadsheet-item .label {\n  float: right;\n  opacity: 0.65;\n  font-size: 1em;\n}\n.x-spreadsheet-item,\n.x-spreadsheet-header,\n.state {\n  padding-left: 35px!important;\n  position: relative;\n}\n.x-spreadsheet-item:before,\n.x-spreadsheet-header:before,\n.state:before {\n  content: '';\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  left: 12px;\n  top: calc(50% - 5px);\n  background: rgba(0, 0, 0, 0.08);\n  border-radius: 2px;\n}\n.state.checked:before {\n  background: #4b89ff;\n}\n.x-spreadsheet-checkbox {\n  position: relative;\n  display: inline-block;\n  backface-visibility: hidden;\n  outline: 0;\n  vertical-align: baseline;\n  font-style: normal;\n  font-size: 1rem;\n  line-height: 1em;\n}\n.x-spreadsheet-checkbox > input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  opacity: 0!important;\n  outline: 0;\n  z-index: -1;\n}\n.x-spreadsheet-suggest,\n.x-spreadsheet-contextmenu,\n.x-spreadsheet-sort-filter {\n  position: absolute;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n  background: #fff;\n  z-index: 100;\n  width: 260px;\n  pointer-events: auto;\n  overflow: auto;\n}\n.x-spreadsheet-suggest {\n  width: 200px;\n}\n.x-spreadsheet-filter {\n  border: 1px solid #e9e9e9;\n  font-size: 12px;\n  margin: 10px;\n}\n.x-spreadsheet-filter .x-spreadsheet-header {\n  padding: 0.5em 0.75em;\n  background: #f8f8f9;\n  border-bottom: 1px solid #e9e9e9;\n  border-left: 1px solid transparent;\n}\n.x-spreadsheet-filter .x-spreadsheet-body {\n  height: 200px;\n  overflow-y: auto;\n}\n.x-spreadsheet-filter .x-spreadsheet-body .x-spreadsheet-item {\n  height: 20px;\n  line-height: 20px;\n}\n.x-spreadsheet-sort-filter .x-spreadsheet-buttons {\n  margin: 10px;\n}\n.x-spreadsheet-toolbar,\n.x-spreadsheet-bottombar {\n  height: 40px;\n  padding: 0 30px;\n  text-align: left;\n  background: #f5f6f7;\n  display: flex;\n}\n.x-spreadsheet-bottombar {\n  position: relative;\n  border-top: 1px solid #e0e2e4;\n}\n.x-spreadsheet-bottombar .x-spreadsheet-menu > li {\n  line-height: 40px;\n  height: 40px;\n  padding-top: 0;\n  padding-bottom: 0;\n  vertical-align: middle;\n  border-right: 1px solid #e8eaed;\n}\n.x-spreadsheet-menu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  user-select: none;\n}\n.x-spreadsheet-menu > li {\n  float: left;\n  line-height: 1.25em;\n  padding: 0.785em 1em;\n  margin: 0;\n  vertical-align: middle;\n  text-align: left;\n  font-weight: 400;\n  color: #80868b;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: all 0.3s;\n  font-weight: bold;\n}\n.x-spreadsheet-menu > li.active {\n  background-color: #fff;\n  color: rgba(0, 0, 0, 0.65);\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon {\n  margin: 0 6px;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon .x-spreadsheet-icon-img:hover {\n  opacity: 0.85;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-dropdown {\n  display: inline-block;\n}\n.x-spreadsheet-toolbar {\n  border-bottom: 1px solid #e0e2e4;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btns {\n  display: inline-flex;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more {\n  padding: 0 6px 6px;\n  text-align: left;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more .x-spreadsheet-toolbar-divider {\n  margin-top: 0;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn {\n  flex: 0 0 auto;\n  display: inline-block;\n  border: 1px solid transparent;\n  height: 26px;\n  line-height: 26px;\n  min-width: 26px;\n  margin: 6px 1px 0;\n  padding: 0;\n  text-align: center;\n  border-radius: 2px;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn:hover,\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.active {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toolbar-divider {\n  display: inline-block;\n  border-right: 1px solid #e0e2e4;\n  width: 0;\n  vertical-align: middle;\n  height: 18px;\n  margin: 12px 3px 0;\n}\n.x-spreadsheet-print {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 100;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.x-spreadsheet-print-bar {\n  background: #424242;\n  height: 60px;\n  line-height: 60px;\n  padding: 0 30px;\n}\n.x-spreadsheet-print-bar .-title {\n  color: #fff;\n  font-weight: bold;\n  font-size: 1.2em;\n  float: left;\n}\n.x-spreadsheet-print-bar .-right {\n  float: right;\n  margin-top: 12px;\n}\n.x-spreadsheet-print-content {\n  display: flex;\n  flex: auto;\n  flex-direction: row;\n  background: #d0d0d0;\n  height: calc(100% - 60px);\n}\n.x-spreadsheet-print-content .-sider {\n  flex: 0 0 300px;\n  width: 300px;\n  border-left: 2px solid #ccc;\n  background: #fff;\n}\n.x-spreadsheet-print-content .-content {\n  flex: auto;\n  overflow-x: auto;\n  overflow-y: scroll;\n  height: 100%;\n}\n.x-spreadsheet-canvas-card-wraper {\n  margin: 40px 20px;\n}\n.x-spreadsheet-canvas-card {\n  background: #fff;\n  margin: auto;\n  page-break-before: auto;\n  page-break-after: always;\n  box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 3px rgba(0, 0, 0, 0.12), 0 4px 5px 0 rgba(0, 0, 0, 0.2);\n}\n.x-spreadsheet-calendar {\n  color: rgba(0, 0, 0, 0.65);\n  background: #ffffff;\n  user-select: none;\n}\n.x-spreadsheet-calendar .calendar-header {\n  font-weight: 700;\n  line-height: 30px;\n  text-align: center;\n  width: 100%;\n  float: left;\n  background: #f9fafb;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-left {\n  padding-left: 5px;\n  float: left;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right {\n  float: right;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a {\n  padding: 3px 0;\n  margin-right: 2px;\n  border-radius: 2px;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a:hover {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-calendar .calendar-body {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n.x-spreadsheet-calendar .calendar-body th,\n.x-spreadsheet-calendar .calendar-body td {\n  width: 14.28571429%;\n  min-width: 32px;\n  text-align: center;\n  font-weight: 700;\n  line-height: 30px;\n  padding: 0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell:hover {\n  background: #ecf6fd;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.active,\n.x-spreadsheet-calendar .calendar-body td > .cell.active:hover {\n  background: #ecf6fd;\n  color: #2185D0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-datepicker {\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);\n  position: absolute;\n  left: 0;\n  top: calc(100% + 5px);\n  z-index: 10;\n  width: auto;\n}\n.x-spreadsheet-buttons {\n  display: flex;\n  justify-content: flex-end;\n}\n.x-spreadsheet-buttons .x-spreadsheet-button {\n  margin-left: 8px;\n}\n.x-spreadsheet-button {\n  display: inline-block;\n  border-radius: 3px;\n  line-height: 1em;\n  min-height: 1em;\n  white-space: nowrap;\n  text-align: center;\n  cursor: pointer;\n  font-size: 1em;\n  font-weight: 700;\n  padding: 0.75em 1em;\n  color: rgba(0, 0, 0, 0.6);\n  background: #E0E1E2;\n  text-decoration: none;\n  font-family: "Lato", "proxima-nova", "Helvetica Neue", Arial, sans-serif;\n  outline: none;\n  vertical-align: baseline;\n  zoom: 1;\n  user-select: none;\n  transition: all 0.1s linear;\n}\n.x-spreadsheet-button.active,\n.x-spreadsheet-button:hover {\n  background-color: #C0C1C2;\n  color: rgba(0, 0, 0, 0.8);\n}\n.x-spreadsheet-button.primary {\n  color: #fff;\n  background-color: #2185D0;\n}\n.x-spreadsheet-button.primary:hover,\n.x-spreadsheet-button.primary.active {\n  color: #fff;\n  background-color: #1678c2;\n}\n.x-spreadsheet-form-input {\n  font-size: 1em;\n  position: relative;\n  font-weight: 400;\n  display: inline-flex;\n  color: rgba(0, 0, 0, 0.87);\n}\n.x-spreadsheet-form-input input {\n  z-index: 1;\n  margin: 0;\n  max-width: 100%;\n  flex: 1 0 auto;\n  outline: 0;\n  -webkit-tap-highlight-color: rgba(255, 255, 255, 0);\n  text-align: left;\n  line-height: 30px;\n  height: 30px;\n  padding: 0 8px;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 3px;\n  transition: box-shadow 0.1s ease, border-color 0.1s ease;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-input input:focus {\n  border-color: #4b89ff;\n  box-shadow: inset 0 1px 2px rgba(75, 137, 255, 0.2);\n}\n.x-spreadsheet-form-select {\n  position: relative;\n  display: inline-block;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 2px;\n  cursor: pointer;\n  color: rgba(0, 0, 0, 0.87);\n  user-select: none;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-select .input-text {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  min-width: 60px;\n  width: auto;\n  height: 30px;\n  line-height: 30px;\n  padding: 0 8px;\n}\n.x-spreadsheet-form-fields {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field {\n  flex: 0 1 auto;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field .label {\n  display: inline-block;\n  margin: 0 10px 0 0;\n}\n.x-spreadsheet-form-field {\n  display: block;\n  vertical-align: middle;\n  margin-left: 10px;\n  margin-bottom: 10px;\n}\n.x-spreadsheet-form-field:first-child {\n  margin-left: 0;\n}\n.x-spreadsheet-form-field.error .x-spreadsheet-form-select,\n.x-spreadsheet-form-field.error input {\n  border-color: #f04134;\n}\n.x-spreadsheet-form-field .tip {\n  color: #f04134;\n  font-size: 0.9em;\n}\n.x-spreadsheet-dimmer {\n  display: none;\n  position: absolute;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  vertical-align: middle;\n  background-color: rgba(0, 0, 0, 0.6);\n  opacity: 0;\n  -webkit-animation-fill-mode: both;\n  animation-fill-mode: both;\n  -webkit-animation-duration: 0.5s;\n  animation-duration: 0.5s;\n  transition: background-color 0.5s linear;\n  user-select: none;\n  z-index: 1000;\n}\n.x-spreadsheet-dimmer.active {\n  display: block;\n  opacity: 1;\n}\nform fieldset {\n  border: none;\n}\nform fieldset label {\n  display: block;\n  margin-bottom: 0.5em;\n  font-size: 1em;\n  color: #666;\n}\nform fieldset select {\n  font-size: 1.1em;\n  width: 100%;\n  background-color: #fff;\n  border: none;\n  border-bottom: 2px solid #ddd;\n  padding: 0.5em 0.85em;\n  border-radius: 2px;\n}\n.x-spreadsheet-modal,\n.x-spreadsheet-toast {\n  font-size: 13px;\n  position: fixed;\n  z-index: 1001;\n  text-align: left;\n  line-height: 1.25em;\n  min-width: 360px;\n  color: rgba(0, 0, 0, 0.87);\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  background-color: #fff;\n  background-clip: padding-box;\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 8px;\n}\n.x-spreadsheet-toast {\n  background-color: rgba(255, 255, 255, 0.85);\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-toast-header {\n  font-weight: 600;\n  background-clip: padding-box;\n  background-color: rgba(255, 255, 255, 0.85);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n  border-radius: 4px 4px 0 0;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon,\n.x-spreadsheet-toast-header .x-spreadsheet-icon {\n  position: absolute;\n  right: 0.8em;\n  top: 0.65em;\n  border-radius: 18px;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon:hover,\n.x-spreadsheet-toast-header .x-spreadsheet-icon:hover {\n  opacity: 1;\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toast-header {\n  color: #F2711C;\n}\n.x-spreadsheet-modal-header {\n  border-bottom: 1px solid #e0e2e4;\n  background: rgba(0, 0, 0, 0.08);\n  font-size: 1.0785em;\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-modal-content,\n.x-spreadsheet-toast-header,\n.x-spreadsheet-toast-content {\n  padding: 0.75em 1em;\n}\n@media screen and (min-width: 320px) and (max-width: 480px) {\n  .x-spreadsheet-toolbar {\n    display: none;\n  }\n}\n.x-spreadsheet-icon {\n  width: 18px;\n  height: 18px;\n  margin: 1px 1px 2px 1px;\n  text-align: center;\n  vertical-align: middle;\n  user-select: none;\n  overflow: hidden;\n  position: relative;\n  display: inline-block;\n  line-height: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img {\n  background-image: url(${f});\n  position: absolute;\n  width: 262px;\n  height: 444px;\n  opacity: 0.56;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.undo {\n  left: 0;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.redo {\n  left: -18px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.print {\n  left: -36px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.paintformat {\n  left: -54px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.clearformat {\n  left: -72px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-bold {\n  left: -90px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-italic {\n  left: -108px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.underline {\n  left: -126px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.strike {\n  left: -144px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.color {\n  left: -162px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.bgcolor {\n  left: -180px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.merge {\n  left: -198px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-left {\n  left: -216px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-center {\n  left: -234px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-right {\n  left: 0;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-top {\n  left: -18px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-middle {\n  left: -36px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-bottom {\n  left: -54px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.textwrap {\n  left: -72px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.autofilter {\n  left: -90px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.formula {\n  left: -108px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-down {\n  left: -126px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-right {\n  left: -144px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.link {\n  left: -162px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chart {\n  left: -180px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.freeze {\n  left: -198px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.ellipsis {\n  left: -216px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.add {\n  left: -234px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-all {\n  left: 0;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-inside {\n  left: -18px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-horizontal {\n  left: -36px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-vertical {\n  left: -54px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-outside {\n  left: -72px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-left {\n  left: -90px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-top {\n  left: -108px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-right {\n  left: -126px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-bottom {\n  left: -144px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-none {\n  left: -162px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-color {\n  left: -180px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-type {\n  left: -198px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.close {\n  left: -234px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-down {\n  left: 0;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-up {\n  left: -18px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-left {\n  left: -36px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-right {\n  left: -54px;\n  top: -54px;\n}\n`,""]);const h=s},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var c=this[l][0];null!=c&&(a[c]=!0)}for(var u=0;u<t.length;u++){var s=[].concat(t[u]);r&&a[s[0]]||(void 0!==i&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=i),n&&(s[2]?(s[1]="@media ".concat(s[2]," {").concat(s[1],"}"),s[2]=n):s[2]=n),o&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=o):s[4]="".concat(o)),e.push(s))}},e}},417:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},a=[],l=0;l<t.length;l++){var c=t[l],u=r.base?c[0]+r.base:c[0],s=i[u]||0,f="".concat(u," ").concat(s);i[u]=s+1;var h=n(f),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var d=o(p,r);r.byIndex=l,e.splice(l,0,{identifier:f,updater:d,references:1})}a.push(f)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var l=n(i[a]);e[l].references--}for(var c=r(t,o),u=0;u<i.length;u++){var s=n(i[u]);0===e[s].references&&(e[s].updater(),e.splice(s,1))}i=c}}},659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},474:(t,e,n)=>{t.exports=n.p+"7a05ab5bcad662d05f5c.svg"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a(r.key),r)}}function a(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,n.nc=void 0;var l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}return e=t,n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n,r=function(t){if(Array.isArray(t))return t}(n=t.split("."))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=r[0],a=r.slice(1),l=i;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,(function(t){e(t);for(var n=0;n<a.length;n+=1){var r=a[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.removeClass(t):this.addClass(t),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){return arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.removeClass("disabled"):this.addClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}],n&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),c=function(t){return new l(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")};function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function f(t){for(var e="",n=t;n>=s.length;)n/=s.length,n-=1,e+=s[parseInt(n,10)%s.length];return e+s[t%s.length]}function h(t){for(var e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function p(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[h(e),parseInt(n,10)-1]}function d(t,e){return"".concat(f(t)).concat(e+1)}function y(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var o,i,a=(o=p(t),i=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(o,i)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],c=a[1];return r(l,c)?d(l+e,c+n):t}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function w(t){var e=function(t){if("object"!=b(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:e+""}var x=function(){function t(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=o,this.w=i,this.h=a}return function(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(1===r.length){var i=v(p(r[0]),2);e=i[0],t=i[1]}else 2===r.length&&(t=r[0],e=r[1]);var a=this.sri,l=this.sci,c=this.eri,u=this.eci;return a<=t&&t<=c&&l<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,o=this.eri,i=this.eci,a=n;a<=o;a+=1)if(e(a))for(var l=r;l<=i;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,o=this.eri,i=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"difference",value:function(e){var n=[],r=function(e,r,o,i){n.push(new t(e,r,o,i))},o=this.sri,i=this.sci,a=this.eri,l=this.eci,c=e.sri-o,u=e.sci-i,s=a-e.eri,f=l-e.eci;return c>0?(r(o,i,e.sri-1,l),s>0?(r(e.eri+1,i,a,l),u>0&&r(e.sri,i,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(u>0&&r(e.sri,i,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,l))):s>0&&(r(e.eri+1,i,a,l),u>0&&r(o,i,e.eri,e.sci-1),f>0&&r(o,e.eci+1,e.eri,l)),u>0?(r(o,i,a,e.sci-1),f>0?(r(o,e.eri+1,a,l),c>0&&r(o,e.sci,e.sri-1,e.eci),s>0&&r(e.sri+1,e.sci,a,e.eci)):(c>0&&r(o,e.sci,e.sri-1,l),s>0&&r(e.sri+1,e.sci,a,l))):f>0&&(r(a,e.eci+1,a,l),c>0&&r(o,i,e.sri-1,e.eci),s>0&&r(e.eri+1,i,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,o=d(e,t);return this.multiple()&&(o="".concat(o,":").concat(d(r,n))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}],[{key:"valueOf",value:function(e){var n=e.split(":"),r=v(p(n[0]),2),o=r[0],i=r[1],a=i,l=o;if(n.length>1){var c=v(p(n[1]),2);l=c[0],a=c[1]}return new t(i,o,a,l)}}])}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,k(r.key),r)}}function k(t){var e=function(t){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}var j=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new x(0,0,0,0),this.ri=0,this.ci=0},(e=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&O(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function T(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function C(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}var _=T((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I(r.key),r)}}function I(t){var e=function(t){if("object"!=A(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==A(e)?e:e+""}var D=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]},(e=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function B(t){var e=function(t){if("object"!=z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:e+""}var H=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"},(e=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&M(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,U(r.key),r)}}function V(t,e,n){return e&&W(t.prototype,e),n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function U(t){var e=function(t){if("object"!=N(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==N(e)?e:e+""}var $=function(){return V((function t(e,n,r){F(this,t),this.ci=e,this.operator=n,this.value=r}),[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}])}(),q=function(){return V((function t(e,n){F(this,t),this.ci=e,this.order=n}),[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}])}(),L=function(){return V((function t(){F(this,t),this.ref=null,this.filters=[],this.sort=null}),[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map((function(t){return new $(t.ci,t.operator,t.value)})),r&&(this.sort=new q(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new $(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new q(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),o=r.sri,i=r.eri,a=this.filters,l=o+1;l<=i;l+=1)for(var c=0;c<a.length;c+=1){var u=a[c],s=t(l,u.ci),f=s?s.text:"";if(!u.includes(f)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),o=r.sri,i=r.eri,a=o+1;a<=i;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))n[""]=(n[""]||0)+1;else{var c=l.text,u=(n[c]||0)+1;n[c]=u}}return n}},{key:"range",value:function(){return x.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}])}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Z(r.key),r)}}function Z(t){var e=function(t){if("object"!=Y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}var J=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach((function(o){var i=o.sri,a=o.sci,l=o.eri,c=o.eci,u=o;"row"===t?i>=e?(u.sri+=n,u.eri+=n):i<e&&e<=l&&(u.eri+=n,r(i,a,n,0)):"column"===t&&(a>=e?(u.sci+=n,u.eci+=n):a<e&&e<=c&&(u.eci+=n,r(i,a,0,n)))}))}},{key:"move",value:function(t,e,n){this._.forEach((function(r){var o=r;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=n,o.eci+=n)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return x.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&X(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),K=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.forEach((function(e){Object.keys(e).forEach((function(n){var r=e[n];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?t[n]=r:"function"!=typeof r&&!Array.isArray(r)&&r instanceof Object?(t[n]=t[n]||{},K(t[n],r)):t[n]=r}))})),t};function G(t){for(var e="".concat(t),n=0,r=!1,o=0;o<e.length;o+=1)!0===r&&(n+=1),"."===e.charAt(o)&&(r=!0);return n}function Q(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=G(e),o=G(n),i=Number(e),a=Number(n),l=0;if("-"===t)l=i-a;else if("+"===t)l=i+a;else if("*"===t)l=i*a;else if("/"===t)return G(l=i/a)>5?l.toFixed(2):l;return l.toFixed(Math.max(r,o))}const tt=function(t){return JSON.parse(JSON.stringify(t))},et=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return K.apply(void 0,[{}].concat(e))},nt=function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var o=0;o<r.length;o+=1){var i=r[o],a=e[i],l=n[i];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var c=0;c<a.length;c+=1)if(!t(a[c],l[c]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},rt=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},ot=function(t,e,n){for(var r=0,o=t;o<e;o+=1)r+=n(o);return r},it=function(t,e,n,r,o,i){for(var a=n,l=r,c=t;c<e&&!(a>o);c+=1)a+=l=i(c);return[c,a-l,l]};function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ct(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,st(r.key),r)}}function st(t){var e=function(t){if("object"!=at(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:e+""}var ft=function(){return t=function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r},e=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return ot(t,e,(function(t){return n&&n.has(t)?0:r.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.getOrNew(t);"all"===r?o.cells[e]=n:"text"===r?(o.cells[e]=o.cells[e]||{},o.cells[e].text=n.text):"format"===r&&(o.cells[e]=o.cells[e]||{},o.cells[e].style=n.style,n.merge&&(o.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){var r=this.getCellOrNew(t,e);!1!==r.editable&&(r.text=n)}},{key:"copyPaste",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=t.sri,l=t.sci,c=t.eri,u=t.eci,s=e.sri,f=e.sci,h=e.eri,p=e.eci,d=lt(t.size(),2),b=d[0],v=d[1],m=lt(e.size(),2),g=m[0],w=m[1],x=!0,S=0;(h<a||p<l)&&(x=!1,S=h<a?g:w);for(var O=a;O<=c;O+=1)if(this._[O])for(var k=l;k<=u;k+=1)if(this._[O].cells&&this._[O].cells[k])for(var j=s;j<=h;j+=b)for(var P=function(){var t=j+(O-a),e=E+(k-l),d=tt(r._[O].cells[k]);if(o&&d&&d.text&&d.text.length>0){var m=d.text,g=E-f+(j-s)+2;if(x||(g-=S+1),"="===m[0])d.text=m.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,n=0;return a===s?e=g-1:n=g-1,/^\d+$/.test(t)?t:y(t,e,n)}));else if(b<=1&&v>1&&(s>c||h<a)||v<=1&&b>1&&(f>u||p<l)||b<=1&&v<=1){var w=/[\\.\d]+$/.exec(m);if(null!==w){var P=Number(w[0])+g-1;d.text=m.substring(0,w.index)+P}}}r.setCell(t,e,d,n),i(t,e,d)},E=f;E<=p;E+=v)P()}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each((function(o){n.eachCells(o,(function(i){var a=parseInt(o,10),l=parseInt(i,10);t.includes(o,i)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[l]=n._[o].cells[i]}))})),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,o=e.sci;t.forEach((function(t,e){var i=r+e;t.forEach((function(t,e){var r=o+e;n.setCellText(i,r,t)}))}))}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each((function(o,i){var a=parseInt(o,10);a>=t&&(a+=n,e.eachCells(o,(function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return y(e,0,n,(function(e,n){return n>=t}))})))}))),r[a]=i})),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,o={};this.each((function(i,a){var l=parseInt(i,10);l<t?o[l]=a:i>e&&(o[l-r]=a,n.eachCells(i,(function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return y(t,0,-r,(function(t,n){return n>e}))})))})))})),this._=o,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(r,o){var i={};e.eachCells(r,(function(e,r){var o=parseInt(e,10);o>=t&&(o+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return y(e,n,0,(function(e){return e>=t}))})))),i[o]=r})),o.cells=i}))}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each((function(o,i){var a={};n.eachCells(o,(function(n,o){var i=parseInt(n,10);i<t?a[i]=o:i>e&&(a[i-r]=o,o.text&&"="===o.text[0]&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return y(t,-r,0,(function(t){return t>e}))}))))})),i.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,r){e.deleteCell(t,r,n)}))}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var o=this.getCell(t,e);null!==o&&!1!==o.editable&&("all"===n?delete r.cells[e]:"text"===n?(o.text&&delete o.text,o.value&&delete o.value):"format"===n?(void 0!==o.style&&delete o.style,o.merge&&delete o.merge):"merge"===n&&o.merge&&delete o.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,o=Object.keys(r),i=o[o.length-1];return[parseInt(e,10),parseInt(i,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var n=lt(e,2),r=n[0],o=n[1];t(r,o)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var n=lt(t,2),r=n[0],o=n[1];e(r,o)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}],e&&ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dt(r.key),r)}}function dt(t){var e=function(t){if("object"!=ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}var yt=function(){return t=function t(e){var n=e.len,r=e.width,o=e.indexWidth,i=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=o,this.minWidth=i},(e=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return ot(t,e,(function(t){return n.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var vt=["en"],mt={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function gt(t,e){if(e){var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}(vt);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!e[o])break;for(var i=e[o],a=t.match(/(?:\\.|[^.])+/g),l=0;l<a.length;l+=1){var c=i[a[l]];if(!c)break;if(l===a.length-1)return c;i=c}}}catch(t){r.e(t)}finally{r.f()}}}function wt(t){var e=gt(t,mt);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=gt(t,window.x_spreadsheet.$messages)),e||""}function xt(t){return function(){return wt(t)}}function St(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?vt=[t]:vt.unshift(t),e&&(mt[t]=e)}function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function kt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return jt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Et(r.key),r)}}function Et(t){var e=function(t){if("object"!=Ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ot(e)?e:e+""}var Tt={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Ct(t,e){var n="";if(!t){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];n=wt.apply(void 0,["validation.".concat(e)].concat(o))}return[t,n]}var _t=function(){return t=function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=o,this.message=""},(e=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?rt(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,o=this.type;if(e&&/^\s*$/.test(t))return Ct(!1,"required");if(/^\s*$/.test(t))return[!0];if(Tt[o]&&!Tt[o].test(t))return Ct(!1,"notMatch");if("list"===o)return Ct(this.values().includes(t),"notIn");if(n){var i=this.parseValue(t);if("be"===n){var a=kt(r,2),l=a[0],c=a[1];return Ct(i>=this.parseValue(l)&&i<=this.parseValue(c),"between",l,c)}if("nbe"===n){var u=kt(r,2),s=u[0],f=u[1];return Ct(i<this.parseValue(s)||i>this.parseValue(f),"notBetween",s,f)}if("eq"===n)return Ct(i===this.parseValue(r),"equal",r);if("neq"===n)return Ct(i!==this.parseValue(r),"notEqual",r);if("lt"===n)return Ct(i<this.parseValue(r),"lessThan",r);if("lte"===n)return Ct(i<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return Ct(i>this.parseValue(r),"greaterThan",r);if("gte"===n)return Ct(i>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&Pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function It(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mt(r.key),r)}}function zt(t,e,n){return e&&Dt(t.prototype,e),n&&Dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mt(t){var e=function(t){if("object"!=Rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}var Bt=function(){function t(e,n,r){It(this,t),this.refs=n,this.mode=e,this.validator=r}return zt(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1)if(x.valueOf(n[r]).includes(t,e))return!0;return!1}},{key:"addRef",value:function(t){this.remove(x.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(n){var r=x.valueOf(n);r.intersects(t)?r.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(n)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,o=e.type,i=e.required,a=e.operator,l=e.value;return new t(r,n,new _t(o,i,l,a))}}])}(),Ht=function(){return zt((function t(){It(this,t),this._=[],this.errors=new Map}),[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r,o,i=this.get(t,e),a="".concat(t,"_").concat(e),l=this.errors;if(null!==i){var c=(r=i.validator.validate(n),o=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(r,o)||function(t,e){if(t){if("string"==typeof t)return At(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(t,e):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],s=c[1];u?l.delete(a):l.set(a,s)}else l.delete(a);return!0}},{key:"add",value:function(t,e,n){var r=n.type,o=n.required,i=n.value,a=n.operator,l=new _t(r,o,i,a),c=this.getByValidator(l);null!==c?c.addRef(e):this._.push(new Bt(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Bt.valueOf(t)}))}}])}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wt(r.key),r)}}function Wt(t){var e=function(t){if("object"!=Nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nt(e)?e:e+""}function Vt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||Ut(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(t,e){if(t){if("string"==typeof t)return $t(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(t,e):void 0}}function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var qt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Lt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,o=e.clone(),i=Vt(t.size(),2),a=i[0],l=i[1],c=Vt(e.size(),2),u=c[0],s=c[1];return a>u&&(o.eri=e.sri+a-1),l>s&&(o.eci=e.sci+l-1),!r.intersects(o)||(n(wt("error.pasteForMergedCell")),!1)}function Yt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,i=this.merges;"all"!==n&&"format"!==n||(o.deleteCells(e,n),i.deleteWithin(e)),o.copyPaste(t,e,n,r,(function(t,e,n){if(n&&n.merge){var r=Vt(n.merge,2),o=r[0],a=r[1];if(o<=0&&a<=0)return;i.add(new x(t,e,t+o,e+a))}}))}function Xt(t,e){var n=this.clipboard,r=this.rows,o=this.merges;r.cutPaste(t,e),o.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function Zt(t,e,n){var r=this.styles,o=this.rows.getCellOrNew(t,e),i={};void 0!==o.style&&(i=tt(r[o.style])),i=et(i,{border:n}),o.style=this.addStyle(i)}function Jt(t){var e=this,n=t.mode,r=t.style,o=t.color,i=this.styles,a=this.selector,l=this.rows,c=a.range,u=c.sri,s=c.sci,f=c.eri,h=c.eci,p=!this.isSingleSelected();if(p||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||p){if("none"===n)a.range.each((function(t,n){var r=l.getCell(t,n);if(r&&void 0!==r.style){var o=tt(i[r.style]);delete o.border,r.style=e.addStyle(o)}}));else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)for(var d=[],y=u;y<=f;y+=1)for(var b=s;b<=h;b+=1){for(var v=[],m=0;m<d.length;m+=1){var g=Vt(d[m],4),w=g[0],x=g[1],S=g[2],O=g[3];if(y===w+S+1&&v.push(m),w<=y&&y<=w+S&&b===x){b+=O+1;break}}if(v.forEach((function(t){return d.splice(t,1)})),b>h)break;var k=l.getCell(y,b),j=0,P=0;if(k&&k.merge){var E=Vt(k.merge,2);j=E[0],P=E[1],d.push([y,b,j,P])}var T=j>0&&y+j===f,C=P>0&&b+P===h,_={};"all"===n?_={bottom:[r,o],top:[r,o],left:[r,o],right:[r,o]}:"inside"===n?(!C&&b<h&&(_.right=[r,o]),!T&&y<f&&(_.bottom=[r,o])):"horizontal"===n?!T&&y<f&&(_.bottom=[r,o]):"vertical"===n?!C&&b<h&&(_.right=[r,o]):"outside"===n&&p&&(u===y&&(_.top=[r,o]),(T||f===y)&&(_.bottom=[r,o]),s===b&&(_.left=[r,o]),(C||h===b)&&(_.right=[r,o])),Object.keys(_).length>0&&Zt.call(this,y,b,_),b+=P}else if("top"===n||"bottom"===n)for(var A=s;A<=h;A+=1)"top"===n&&(Zt.call(this,u,A,{top:[r,o]}),A+=l.getCellMerge(u,A)[1]),"bottom"===n&&(Zt.call(this,f,A,{bottom:[r,o]}),A+=l.getCellMerge(f,A)[1]);else if("left"===n||"right"===n)for(var R=u;R<=f;R+=1)"left"===n&&(Zt.call(this,R,s,{left:[r,o]}),R+=l.getCellMerge(R,s)[0]),"right"===n&&(Zt.call(this,R,h,{right:[r,o]}),R+=l.getCellMerge(R,h)[0])}else Zt.call(this,u,s,{top:[r,o],bottom:[r,o],left:[r,o],right:[r,o]})}function Kt(t,e){var n=this.rows,r=this.freezeTotalHeight(),o=n.height;r+n.height<t&&(o-=e);for(var i=this.exceptRowSet,a=0,l=o,c=n.height;a<n.len&&!(l>t);a+=1)i.has(a)||(l+=c=n.getHeight(a));return(l-=c)<=0?{ri:-1,top:0,height:c}:{ri:a-1,top:l,height:c}}function Gt(t,e){var n=this.cols,r=this.freezeTotalWidth(),o=n.indexWidth;r+n.indexWidth<t&&(o-=e);var i=Vt(it(0,n.len,o,n.indexWidth,t,(function(t){return n.getWidth(t)})),3),a=i[0],l=i[1],c=i[2];return l<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:l,width:c}}var Qt=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=et(qt,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new J,this.rows=new ft(this.settings.row),this.cols=new yt(this.settings.col),this.validations=new Ht,this.hyperlinks={},this.comments={},this.selector=new j,this.scroll=new _,this.history=new D,this.clipboard=new H,this.autoFilter=new L,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map},e=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData((function(){r.validations.add(t,e,n)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,o=this.validations.get(e,n),i={ref:r.toString()};return null!==o&&(i.mode=o.mode,i.validator=o.validator),i}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],n=this.selector.range,r=n.sri,o=n.eri,i=n.sci,a=n.eci,l=r;l<=o;l+=1){for(var c=[],u=i;u<=a;u+=1){var s=this.getCell(l,u);c.push(s&&s.text||"")}e.push(c)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,o=this.selector;return!r.isClear()&&!!Lt.call(this,r.range,o.range,n)&&(this.changeData((function(){r.isCopy()?Yt.call(t,r.range,o.range,e):r.isCut()&&Xt.call(t,r.range,o.range)})),!0)}},{key:"pasteFromSystemClipboard",value:function(t,e){var n=this,r=this.selector;navigator.clipboard.readText().then((function(o){var i=n.parseClipboardContent(o),a=r.ri;i.forEach((function(t){var e=r.ci;t.forEach((function(t){n.setCellText(a,e,t,"input"),e+=1})),a+=1})),t(),e(n.rows.getData())}))}},{key:"parseClipboardContent",value:function(t){var e=[],n=t.split("\n"),r=0;return n.forEach((function(t){e[r]=t.split("\t"),r+=1})),e}},{key:"pasteFromText",value:function(t){var e;if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var n=this.rows,r=this.selector;this.changeData((function(){n.paste(e,r.range)}))}}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=this.selector.range;return!!Lt.call(this,o,t,r)&&(this.changeData((function(){Yt.call(n,o,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,o=this.cols,i=this.merges,a=n.range,l=a.sri,c=a.sci,u=a.eri,s=a.eci,f=n.ri,h=n.ci,p=t,d=e;return t<0&&(p=r.len-1),e<0&&(d=o.len-1),p>f?(l=f,u=p):(l=p,u=f),d>h?(c=h,s=d):(c=d,s=h),n.range=i.union(new x(l,c,u,s)),n.range=i.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,o=this.cols,i=this.merges.getFirstIncludes(t,e);return null===i&&(i=new x(t,e,t,e),-1===t&&(i.sri=0,i.eri=r.len-1),-1===e&&(i.sci=0,i.eci=o.len-1)),n.range=i,i}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData((function(){var r=n.selector,o=n.styles,i=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)Jt.call(n,e);else if("formula"===t){var a=r.ri,l=r.ci,c=r.range;if(r.multiple()){var u=Vt(r.size(),2),s=u[0],f=u[1],h=c.sri,p=c.sci,y=c.eri,b=c.eci;if(s>1)for(var v=p;v<=b;v+=1)i.getCellOrNew(y+1,v).text="=".concat(e,"(").concat(d(v,h),":").concat(d(v,y),")");else f>1&&(i.getCellOrNew(a,b+1).text="=".concat(e,"(").concat(d(p,a),":").concat(d(b,a),")"))}else i.getCellOrNew(a,l).text="=".concat(e,"()")}else r.range.each((function(r,a){var l=i.getCellOrNew(r,a),c={};if(void 0!==l.style&&(c=tt(o[l.style])),"format"===t)c.format=e,l.style=n.addStyle(c);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};u[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},u),l.style=n.addStyle(c)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(c[t]=e,l.style=n.addStyle(c)):l[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,o=this.rows,i=r.ri,a=r.ci,l=i;this.unsortedRowMap.has(i)&&(l=this.unsortedRowMap.get(i));var c=o.getCell(l,a),u=c?c.text:"";if(this.setCellText(l,a,t,e),n.active()){var s=n.getFilter(a);if(s){var f=s.value.findIndex((function(t){return t===u}));f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,o=n.top,i=n.width,a=n.height,l=t-this.cols.indexWidth,c=e-this.rows.height;return l>r&&l<r+i&&c>o&&c<o+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,o=this.exceptRowSet,i=t.sri,a=t.sci,l=t.eri,c=t.eci;if(i<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var u=r.sumWidth(0,a),s=n.sumHeight(0,i,o),f=n.sumHeight(i,l+1,o),h=r.sumWidth(a,c+1),p=u-e.x,d=s-e.y,y=this.freezeTotalHeight(),b=this.freezeTotalWidth();return b>0&&b>u&&(p=u),y>0&&y>s&&(d=s),{l:u,t:s,left:p,top:d,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,o=this.rows,i=this.cols,a=Kt.call(this,e,n.y),l=a.ri,c=a.top,u=a.height,s=Gt.call(this,t,n.x),f=s.ci,h=s.left,p=s.width;if(-1===f&&(p=i.totalWidth()),-1===l&&(u=o.totalHeight()),l>=0||f>=0){var d=r.getFirstIncludes(l,f);if(d){l=d.sri,f=d.sci;var y=this.cellRect(l,f);h=y.left,c=y.top,p=y.width,u=y.height}}return{ri:l,ci:f,left:h,top:c,width:p,height:u}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,o=t.eci,i=this.getCell(e,n);if(i&&i.merge){var a=Vt(i.merge,2),l=a[0],c=a[1];if(e+l===r&&n+c===o)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,o=t.eci,i=this.getCell(e,n);if(i&&i.merge){var a=Vt(i.merge,2),l=a[0],c=a[1];if(e+l===r&&n+c===o)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSingleSelected()){var r=Vt(e.size(),2),o=r[0],i=r[1];if(o>1||i>1){var a=e.range,l=a.sri,c=a.sci;this.changeData((function(){var r=n.getCellOrNew(l,c);r.merge=[o-1,i-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(l,c,r)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var n=e.range,r=n.sri,o=n.sci;this.changeData((function(){t.rows.deleteCell(r,o,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,n,r){var o=this.autoFilter;o.addFilter(t,n,r),o.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,o=e.filteredRows((function(t,e){return n.getCell(t,e)})),i=o.rset,a=o.fset,l=Array.from(a),c=Array.from(a);r&&l.sort((function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0})),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach((function(e,n){t.sortedRowMap.set(c[n],e),t.unsortedRowMap.set(e,c[n])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData((function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)}))}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var r=e.selector.range,o=r.sri,i=r.sci,a=e.rows,l=e.merges,c=e.cols,u=o;"row"===t?a.insert(o,n):"column"===t&&(a.insertColumn(i,n),u=i,c.len+=n,Object.keys(c._).reverse().forEach((function(t){var e=parseInt(t,10);e>=i&&(c._[e+n]=c._[e],delete c._[e])}))),l.shift(t,u,n,(function(t,e,n,r){var o=a.getCell(t,e);o.merge[0]+=n,o.merge[1]+=r}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var n=e.rows,r=e.merges,o=e.selector,i=e.cols,a=o.range,l=o.range,c=l.sri,u=l.sci,s=l.eri,f=l.eci,h=Vt(o.range.size(),2),p=h[0],d=h[1],y=c,b=p;"row"===t?n.delete(c,s):"column"===t&&(n.deleteColumn(u,f),y=a.sci,b=d,i.len-=f-u+1,Object.keys(i._).forEach((function(t){var e=parseInt(t,10);e>=u&&(e>f&&(i._[e-(f-u+1)]=i._[e]),delete i._[e])}))),r.shift(t,y,-b,(function(t,e,r,o){var i=n.getCell(t,e);i.merge[0]+=r,i.merge[1]+=o,0===i.merge[0]&&0===i.merge[1]&&delete i.merge}))}))}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,o=this.cols,i=Vt(r,2)[1],a=Vt(it(i,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),l=a[0],c=a[1],u=a[2],s=c;t>0&&(s+=u),n.x!==s&&(n.ci=t>0?l:0,n.x=s,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,o=this.rows,i=Vt(r,1)[0],a=Vt(it(i,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),l=a[0],c=a[1],u=a[2],s=c;t>0&&(s+=u),n.y!==s&&(n.ri=t>0?l:0,n.y=s,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,o=r.sumWidth(0,e),i=n.sumHeight(0,t),a=n.getCell(t,e),l=r.getWidth(e),c=n.getHeight(t);if(null!==a&&a.merge){var u=Vt(a.merge,2),s=u[0],f=u[1];if(s>0)for(var h=1;h<=s;h+=1)c+=n.getHeight(t+h);if(f>0)for(var p=1;p<=f;p+=1)l+=r.getWidth(e+p)}return{left:o,top:i,width:l,height:c,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),o=r&&void 0!==r.style?n[r.style]:{};return et(this.defaultStyle(),o)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var o=this.rows,i=this.history,a=this.validations;"finished"===r?(o.setCellText(t,e,""),i.add(this.getData()),o.setCellText(t,e,n)):(o.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=Vt(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData((function(){n.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData((function(){n.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData((function(){n.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=t.showBottomBar,o=e.height();return r&&(o-=41),n&&(o-=41),o}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=Vt(this.freeze,2),e=t[0],n=t[1];return new x(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=Vt(t.maxCell(),2),r=n[0],o=n[1],i=t.sumHeight(0,r+1),a=e.sumWidth(0,o+1);return new x(0,0,r,o,a,i)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,o=Array.from(n),i=0;return o.forEach((function(n){if(n<t||n>e){var o=r.getHeight(n);i+=o}})),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,o=this.exceptRowSet,i=t.ri,a=t.ci;i<=0&&(i=Vt(r,1)[0]),a<=0&&(a=Vt(r,2)[1]);for(var l=0,c=0,u=[e.len,n.len],s=u[0],f=u[1],h=i;h<e.len&&(o.has(h)||(c+=e.getHeight(h),s=h),!(c>this.viewHeight()));h+=1);for(var p=a;p<n.len&&(f=p,!((l+=n.getWidth(p))>this.viewWidth()));p+=1);return new x(i,a,s,f,l,c)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=Vt(n.size(),2),o=r[0],i=r[1],a=n.range,l=a.sri,c=a.sci,u=a.eri,s=a.eci;if(o===t.len)for(var f=c;f<=s;f+=1)e.setHide(f,!0);else if(i===e.len)for(var h=l;h<=u;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,o=this.rows,i=this.exceptRowSet,a=function(t){if(Array.isArray(t))return $t(t)}(u=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||Ut(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=0,c=0;c<a.length;c+=1)a[c]<t&&(l+=1);for(var u,s=t+l;s<=e+l;s+=1)if(i.has(s))l+=1;else{var f=o.getHeight(s);if(f>0&&(n(s,r,f),(r+=f)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,o=this.cols,i=t;i<=e;i+=1){var a=o.getWidth(i);if(a>0&&(n(i,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(nt(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=Vt(p(t[n]),2),o=r[0],i=r[1];e.freeze=[i,o]}else"autofilter"===n?e.autoFilter.setData(t[n]):void 0!==t[n]&&(e[n]=t[n])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,o=this.rows,i=this.cols,a=this.validations,l=this.autoFilter;return{name:t,freeze:d(e[1],e[0]),styles:n,merges:r.getData(),rows:o.getData(),cols:i.getData(),validations:a.getData(),autofilter:l.getData()}}}],e&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function te(t,e){if(t){if("string"==typeof t)return ee(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(t,e):void 0}}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ne(t,e,n){t.addEventListener(e,n)}function re(t,e,n){t.removeEventListener(e,n)}function oe(t){t.xclickoutside&&(re(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function ie(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),oe(t)))},ne(window.document.body,"click",t.xclickoutside)}function ae(t,e,n){ne(t,"mousemove",e),t.xEvtUp=function(r){re(t,"mousemove",e),re(t,"mouseup",t.xEvtUp),n(r)},ne(t,"mouseup",t.xEvtUp)}function le(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}var ce="x-spreadsheet";function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fe(r.key),r)}}function fe(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}window.devicePixelRatio;var he=function(){return t=function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=c("div","".concat(ce,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=c("div","".concat(ce,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=c("div","".concat(ce,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=c("div","".concat(ce,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}},e=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,o=this.hoverEl,i=this.lineEl,a=this.el,l=this.unhideHoverEl;if(!n){this.cRect=t;var c=t.left,u=t.top,s=t.width,f=t.height;a.offset({left:r?c+s-5:c,top:r?u:u+f-5}).show(),o.offset({width:r?5:s,height:r?f:5}),i.offset({width:r?0:e.width,height:r?e.height:0}),l.offset({left:r?5-s:c,top:r?u:5-f,width:r?5:s,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,o=this.lineEl,i=this.cRect,a=this.vertical,l=this.minDistance,c=a?i.width:i.height;o.show(),ae(window,(function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(c+=t.movementX)>l&&r.css("left","".concat(i.left+c,"px")):(c+=t.movementY)>l&&r.css("top","".concat(i.top+c,"px")),n=t)}),(function(){n=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<l&&(c=l),e.finishedFn(i,c))}))}}],e&&se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ye(r.key),r)}}function ye(t){var e=function(t){if("object"!=pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pe(e)?e:e+""}var be=function(){return t=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=c("div","".concat(ce,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=c("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,r=e.scrollTop,o=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:o,t)}))},(e=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&de(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ve(t){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(t)}function me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xe(r.key),r)}}function we(t,e,n){return e&&ge(t.prototype,e),n&&ge(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xe(t){var e=function(t){if("object"!=ve(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ve(e)?e:e+""}var Se=10,Oe=function(){return we((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];me(this,t),this.useHideInput=n,this.autoFocus=r,this.inputChange=function(){},this.cornerEl=c("div","".concat(ce,"-selector-corner")),this.areaEl=c("div","".concat(ce,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=c("div","".concat(ce,"-selector-clipboard")).hide(),this.autofillEl=c("div","".concat(ce,"-selector-autofill")).hide(),this.el=c("div","".concat(ce,"-selector")).css("z-index","".concat(Se)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=c("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=c("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=c("div","hide-input").child(this.hideInput))),Se+=1}),[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,o=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:o-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,o=t.height;this.autofillEl.offset({width:r-3,height:o-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}])}();function ke(t){var e=this.data,n=t.left,r=t.top,o=t.width,i=t.height,a=t.scroll,l=t.l,c=t.t,u=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=n-u;u>l&&(f-=a.x);var h=r-s;return s>c&&(h-=a.y),{left:f,top:h,width:o,height:i}}function je(t){var e=this.data,n=t.left,r=t.width,o=t.height,i=t.l,a=t.t,l=t.scroll,c=e.freezeTotalWidth(),u=n-c;return c>i&&(u-=l.x),{left:u,top:a,width:r,height:o}}function Pe(t){var e=this.data,n=t.top,r=t.width,o=t.height,i=t.l,a=t.t,l=t.scroll,c=e.freezeTotalHeight(),u=n-c;return c>a&&(u-=l.y),{left:i,top:u,width:r,height:o}}function Ee(t){this.br.setAreaOffset(ke.call(this,t))}function Te(t){this.tl.setAreaOffset(t)}function Ce(t){this.t.setAreaOffset(je.call(this,t))}function _e(t){this.l.setAreaOffset(Pe.call(this,t))}function Ae(t){this.l.setClipboardOffset(Pe.call(this,t))}function Re(t){this.br.setClipboardOffset(ke.call(this,t))}function Ie(t){this.tl.setClipboardOffset(t)}function De(t){this.t.setClipboardOffset(je.call(this,t))}function ze(t){Ee.call(this,t),Te.call(this,t),Ce.call(this,t),_e.call(this,t)}function Me(t){Re.call(this,t),Ie.call(this,t),De.call(this,t),Ae.call(this,t)}var Be=function(){return we((function t(e){var n=this;me(this,t);var r=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new Oe(!0,r),this.t=new Oe,this.l=new Oe,this.tl=new Oe,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=c("div","".concat(ce,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Se+=1}),[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,o=this.br,i=t.freezeTotalHeight(),a=t.freezeTotalWidth();i>0||a>0?(e.setOffset({width:a,height:i}),n.setOffset({left:a,height:i}),r.setOffset({top:i,width:a}),o.setOffset({left:a,top:i})):(e.hide(),n.hide(),r.hide(),o.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ze.call(this,t),Me.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ee.call(this,t),Ce.call(this,t),Re.call(this,e),De.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ee.call(this,t),_e.call(this,t),Re.call(this,e),Ae.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,o=r.calSelectedRangeByStart(t,e),i=o.sri,a=o.sci;if(n){var l=t,c=e;t<0&&(l=0),e<0&&(c=0),r.selector.setIndexes(l,c),this.indexes=[l,c]}this.moveIndexes=[i,a],this.range=o,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,o=this.lastri,i=this.lastci;if(n){if(t===o&&e===i)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),ze.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,o=n.sci,i=n.eri,a=n.eci,l=t,c=e,u=r-t,s=i-t,f=a-e;if(o-e>0)this.arange=new x(r,c,i,o-1);else if(u>0)this.arange=new x(l,o,r-1,a);else if(f<0)this.arange=new x(r,a+1,i,c);else{if(!(s<0))return void(this.arange=null);this.arange=new x(i+1,o,l,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,d=this.l,y=this.t,b=this.tl;p.showAutofill(ke.call(this,h)),d.showAutofill(Pe.call(this,h)),y.showAutofill(je.call(this,h)),b.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Me.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}])}();function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,We(r.key),r)}}function We(t){var e=function(t){if("object"!=He(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==He(e)?e:e+""}function Ve(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Ue(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function $e(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function qe(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:case 39:default:t.stopPropagation();break;case 38:Ve.call(this,t);break;case 40:Ue.call(this,t);break;case 13:case 9:$e.call(this,t)}}var Le=function(){return t=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=c("div","".concat(ce,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1},e=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),oe(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n,r=this,o=this.items;if(/^\s*$/.test(t)||(o=o.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),o=o.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=c("div","".concat(ce,"-item")).child(e).on("click.stop",(function(){r.itemClick(t),r.hide()}));return t.label&&n.child(c("div","label").html(t.label)),n})),this.filterItems=o,!(o.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,(n=o,function(t){if(Array.isArray(t))return Ne(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Ne(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ne(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).show(),ie(i.parent(),(function(){r.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return qe.call(e,t)}))}}],e&&Fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ye(t){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(t)}function Xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ze(r.key),r)}}function Ze(t){var e=function(t){if("object"!=Ye(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ye(e)?e:e+""}function Je(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Je=function(){return!!t})()}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(t)}function Ge(t,e){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ge(t,e)}var Qe=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=Ke(e),function(t,e){if(e&&("object"==Ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Je()?Reflect.construct(e,n||[],Ke(t).constructor):e.apply(t,n))}(this,e,["div","".concat(ce,"-icon")])).iconNameEl=c("div","".concat(ce,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ge(t,e)}(e,t),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(ce,"-icon-img ").concat(t))}}])&&Xe(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(l);function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t){return function(t){if(Array.isArray(t))return nn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return nn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,on(r.key),r)}}function on(t){var e=function(t){if("object"!=tn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tn(e)?e:e+""}function an(t,e){t.setMonth(t.getMonth()+e)}function ln(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var cn=function(){return t=function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=c("div","calendar-header-left"),this.bodyEl=c("tbody",""),this.buildAll(),this.el=c("div","x-spreadsheet-calendar").children(c("div","calendar-header").children(this.headerLeftEl,c("div","calendar-header-right").children(c("a","calendar-prev").on("click.stop",(function(){return r.prev()})).child(new Qe("chevron-left")),c("a","calendar-next").on("click.stop",(function(){return r.next()})).child(new Qe("chevron-right")))),c("table","calendar-body").children(c("thead","").child((n=c("tr","")).children.apply(n,en(wt("calendar.weeks").map((function(t){return c("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}},(e=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){an(this.value,-1),this.buildAll()}},{key:"next",value:function(){an(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(wt("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,o=this.bodyEl,i=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),o=[[],[],[],[],[],[]],i=0;i<6;i+=1)for(var a=0;a<7;a+=1){var l=ln(r,7*i+a),c=l.getMonth()!==e,u=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();o[i][a]={d:l,disabled:c,active:u}}return o}(n.getFullYear(),n.getMonth(),r).map((function(t){var n,r=t.map((function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),c("td","").child(c("div",n).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(n=c("tr","")).children.apply(n,en(r))}));(t=o.html("")).children.apply(t,en(i))}}])&&rn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function un(t){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},un(t)}function sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fn(r.key),r)}}function fn(t){var e=function(t){if("object"!=un(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==un(e)?e:e+""}var hn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new cn(new Date),this.el=c("div","".concat(ce,"-datepicker")).child(this.calendar.el).hide()},(e=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&sn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yn(r.key),r)}}function yn(t){var e=function(t){if("object"!=pn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pn(e)?e:e+""}function bn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function vn(){var t,e=this.inputText;if(!/^\s*$/.test(e)){var n=this.textlineEl,r=this.textEl,o=this.areaOffset,i=e.split("\n"),a=Math.max.apply(Math,function(t){if(Array.isArray(t))return bn(t)}(t=i.map((function(t){return t.length})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return bn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=n.offset().width/e.length,c=(a+1)*l+5,u=this.viewFn().width-o.left-l,s=i.length;if(c>o.width){var f=c;c>u&&(f=u,s+=parseInt(c/u,10),s+=c%u>0?1:0),r.css("width","".concat(f,"px"))}(s*=this.rowHeight)>o.height&&r.css("height","".concat(s,"px"))}}function mn(t,e){var n=t.target,r=n.value,o=n.selectionEnd,i="".concat(r.slice(0,o)).concat(e).concat(r.slice(o));n.value=i,n.setSelectionRange(o+1,o+1),this.inputText=i,this.textlineEl.html(i),vn.call(this)}function gn(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(mn.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function wn(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,o=this.validator,i=this.cell;if(null!==i)if("editable"in i&&!0===i.editable||void 0===i.editable){if(this.inputText=e,o)"list"===o.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),vn.call(this),this.change("input",e)}else t.target.value=i.text||"";else{if(this.inputText=e,o)"list"===o.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}r.html(e),vn.call(this),this.change("input",e)}}function xn(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function Sn(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),xn.call(this,e)}function On(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var o=e.lastIndexOf("="),i=e.substring(0,o+1),a=e.substring(o+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(i+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}Sn.call(this,this.inputText,r)}function kn(){this.suggest.setItems(this.formulas)}var jn=function(){return t=function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new Le(e,(function(t){On.call(o,t)})),this.datepicker=new hn,this.datepicker.change((function(t){o.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),o.clear()})),this.areaEl=c("div","".concat(ce,"-editor-area")).children(this.textEl=c("textarea","").on("input",(function(t){return wn.call(o,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return gn.call(o,t)})),this.textlineEl=c("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=c("div","".concat(ce,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}},e=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),kn.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,o=this.suggest,i=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,c=t.top,u=t.width,s=t.height,f=t.l,h=t.t,p={left:0,top:0};i.w>f&&i.h>h||(i.w<f&&i.h<h?(p.left=i.w,p.top=i.h):i.w>f?p.top=i.h:i.h>h&&(p.left=i.w)),a.offset(p),r.offset({left:l-p.left-.8,top:c-p.top-.8}),n.offset({width:u-9+.8,height:s-3+.8});var d={left:0};d[e]=s,o.setOffset(d),o.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var n=this.el,r=this.datepicker,o=this.suggest;n.show(),this.cell=t;var i=t&&t.text||"";if(this.setText(i),this.validator=e,e){var a=e.type;"date"===a&&(r.show(),/^\s*$/.test(i)||r.setValue(i)),"list"===a&&(o.setItems(e.values()),o.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,Sn.call(this,t,t.length),vn.call(this)}}],e&&dn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Pn(t){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pn(t)}function En(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(En=function(){return!!t})()}function Tn(t){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tn(t)}function Cn(t,e){return Cn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Cn(t,e)}var _n=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=Tn(e),function(t,e){if(e&&("object"==Pn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,En()?Reflect.construct(e,n||[],Tn(t).constructor):e.apply(t,n))}(this,e,["div","".concat(ce,"-button ").concat(r)])).child(wt("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cn(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(l);function An(t){return function(t){if(Array.isArray(t))return Dn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||In(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||In(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(t,e){if(t){if("string"==typeof t)return Dn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dn(t,e):void 0}}function Dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function zn(t){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zn(t)}function Mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nn(r.key),r)}}function Hn(t,e,n){return e&&Bn(t.prototype,e),n&&Bn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nn(t){var e=function(t){if("object"!=zn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=zn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zn(e)?e:e+""}function Fn(){return window.devicePixelRatio||1}function Wn(){return Fn()-.5}function Vn(t){return parseInt(t*Fn(),10)}function Un(t){var e=Vn(t);return e>0?e-.5:.5}var $n=function(){return Hn((function t(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Mn(this,t),this.x=e,this.y=n,this.width=r,this.height=o,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}),[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,o=t.right;e&&(this.borderTop=e),o&&(this.borderRight=o),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,o=this.y;return"top"===t?o+=r:"middle"===t?o+=n/2-e/2:"bottom"===t&&(o+=n-r-e),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}])}();function qn(t,e,n,r,o,i,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===o?0:"top"===o?-(i+2):-i/2:"strike"===t&&("bottom"===o?l.y=i/2:"top"===o&&(l.y=-(i/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}var Ln=function(){return Hn((function t(e,n,r){Mn(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(Fn(),Fn())}),[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Vn(t),this.el.height=Vn(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Vn(t),Vn(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Vn(t)-.5,Vn(e)-.5,Vn(n),Vn(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Vn(e),Vn(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,a=r.align,l=r.valign,c=r.font,u=r.color,s=r.strike,f=r.underline,h=e.textx(a);i.save(),i.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(c.italic?"italic":""," ").concat(c.bold?"bold":""," ").concat(Vn(c.size),"px ").concat(c.name),fillStyle:u,strokeStyle:u});var p="".concat(t).split("\n"),d=e.innerWidth(),y=[];p.forEach((function(t){var e=i.measureText(t).width;if(o&&e>Vn(d)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=Vn(d)&&(y.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=i.measureText(t[r]).width+1;n.len>0&&y.push(t.substr(n.start,n.len))}else y.push(t)}));var b=(y.length-1)*(c.size+2),v=e.texty(l,b);return y.forEach((function(t){var e=i.measureText(t).width;n.fillText(t,h,v),s&&qn.call(n,"strike",h,v,a,l,c.size,e),f&&qn.call(n,"underline",h,v,a,l,c.size,e),v+=c.size+2})),i.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=Wn,n.strokeStyle=e,"medium"===t?n.lineWidth=Vn(2)-.5:"thick"===t?n.lineWidth=Vn(3):"dashed"===t?n.setLineDash([Vn(3),Vn(2)]):"dotted"===t?n.setLineDash([Vn(1),Vn(1)]):"double"===t&&n.setLineDash([Vn(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=Rn(arguments.length<=0?void 0:arguments[0],2),n=e[0],r=e[1];t.moveTo(Un(n),Un(r));for(var o=1;o<arguments.length;o+=1){var i=Rn(o<0||arguments.length<=o?void 0:arguments[o],2),a=i[0],l=i[1];t.lineTo(Un(a),Un(l))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,o=t.borderBottom,i=t.borderLeft;n&&(this.border.apply(this,An(n)),this.line.apply(this,An(t.topxys()))),r&&(this.border.apply(this,An(r)),this.line.apply(this,An(t.rightxys()))),o&&(this.border.apply(this,An(o)),this.line.apply(this,An(t.bottomxys()))),i&&(this.border.apply(this,An(i)),this.line.apply(this,An(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,o=n+t.width-15,i=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Vn(o),Vn(i)),e.lineTo(Vn(o+8),Vn(i)),e.lineTo(Vn(o+4),Vn(i+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,o=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Vn(o-8),Vn(r-1)),e.lineTo(Vn(o),Vn(r-1)),e.lineTo(Vn(o),Vn(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,o=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Vn(o-8),Vn(r-1)),e.lineTo(Vn(o),Vn(r-1)),e.lineTo(Vn(o),Vn(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,o=t.y,i=t.width,a=t.height,l=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=l||"#fff",n.rect(Un(r+1),Un(o+1),Vn(i-2),Vn(a-2)),n.clip(),n.fill(),e(),n.restore()}}])}(),Yn=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Xn=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Zn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Jn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Kn=function(t,e){var n=Zn(t,1)[0],r=t;if('"'===n)return t.substring(1);var o=1;if("-"===n&&(r=t.substring(1),o=-1),r[0]>="0"&&r[0]<="9")return o*Number(r);var i=Zn(p(r),2);return o*e(i[0],i[1])},Gn=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===t[0]){var o=function(t){for(var e=[],n=[],r=[],o=0,i="",a=1,l="",c=0;c<t.length;c+=1){var u=t.charAt(c);if(" "!==u){if(u>="a"&&u<="z")r.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)r.push(u);else if('"'===u){for(c+=1;'"'!==t.charAt(c);)r.push(t.charAt(c)),c+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===u&&/[+\-*/,(]/.test(l))r.push(u);else{if("("!==u&&r.length>0&&n.push(r.join("")),")"===u){var s=e.pop();if(2===o)try{for(var f=Zn(p(n.pop()),2),h=f[0],y=f[1],b=Zn(p(n.pop()),2),v=b[0],m=b[1],g=0,w=v;w<=h;w+=1)for(var x=m;x<=y;x+=1)n.push(d(w,x)),g+=1;n.push([s,g])}catch(t){}else if(1===o||3===o)3===o&&n.push(i),n.push([s,a]),a=1;else for(;"("!==s&&(n.push(s),!(e.length<=0));)s=e.pop();o=0}else if("="===u||">"===u||"<"===u){var S=t.charAt(c+1);i=u,"="!==S&&"-"!==S||(i+=S,c+=1),o=3}else if(":"===u)o=2;else if(","===u)3===o&&n.push(i),o=1,a+=1;else if("("===u&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===u||"-"===u)){var O=e[e.length-1];if("("!==O&&n.push(e.pop()),"*"===O||"/"===O)for(;e.length>0&&"("!==(O=e[e.length-1]);)n.push(e.pop())}else if(e.length>0){var k=e[e.length-1];"*"!==k&&"/"!==k||n.push(e.pop())}e.push(u)}r=[]}l=u}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n}(t.substring(1));return o.length<=0?t:function(t,e,n,r){for(var o=[],i=0;i<t.length;i+=1){var a=t[i],l=a[0];if("+"===a){var c=o.pop();o.push(Q("+",o.pop(),c))}else if("-"===a)if(1===o.length){var u=o.pop();o.push(Q("*",u,-1))}else{var s=o.pop();o.push(Q("-",o.pop(),s))}else if("*"===a)o.push(Q("*",o.pop(),o.pop()));else if("/"===a){var f=o.pop();o.push(Q("/",o.pop(),f))}else if("="===l||">"===l||"<"===l){var h=o.pop();Number.isNaN(h)||(h=Number(h));var p=o.pop();Number.isNaN(p)||(p=Number(p));var d=!1;"="===l?d=p===h:">"===a?d=p>h:">="===a?d=p>=h:"<"===a?d=p<h:"<="===a&&(d=p<=h),o.push(d)}else if(Array.isArray(a)){for(var y=Zn(a,2),b=y[0],v=y[1],m=[],g=0;g<v;g+=1)m.push(o.pop());o.push(e[b].render(m.reverse()))}else{if(r.includes(a))return 0;(l>="a"&&l<="z"||l>="A"&&l<="Z")&&r.push(a),o.push(Kn(a,n)),r.pop()}}return o[0]}(o,e,(function(t,o){return Gn(n(t,o),e,n,r)}),r)}return t};const Qn={render:Gn};function tr(t){return function(t){if(Array.isArray(t))return nr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||er(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(t,e){if(t){if("string"==typeof t)return nr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nr(t,e):void 0}}function nr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var rr=[{key:"SUM",title:xt("formula.sum"),render:function(t){return t.reduce((function(t,e){return Q("+",t,e)}),0)}},{key:"AVERAGE",title:xt("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:xt("formula.max"),render:function(t){return Math.max.apply(Math,tr(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:xt("formula.min"),render:function(t){return Math.min.apply(Math,tr(t.map((function(t){return Number(t)}))))}},{key:"IF",title:xt("formula._if"),render:function(t){var e,n,r=(n=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,n)||er(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=r[2];return o?i:a}},{key:"AND",title:xt("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:xt("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:xt("formula.concat"),render:function(t){return t.join("")}}],or=rr,ir={};function ar(t,e){if(t){if("string"==typeof t)return lr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lr(t,e):void 0}}function lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function cr(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}rr.forEach((function(t){ir[t.key]=t}));var ur=function(t){return t},sr=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=function(t){if(Array.isArray(t))return t}(o=Number(t).toFixed(2).toString().split("\\."))||cr(o)||ar(o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(function(t){return function(t){if(Array.isArray(t))return lr(t)}(t)||cr(t)||ar(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r))}var o;return t},fr=[{key:"normal",title:xt("format.normal"),type:"string",render:ur},{key:"text",title:xt("format.text"),type:"string",render:ur},{key:"number",title:xt("format.number"),type:"number",label:"1,000.12",render:sr},{key:"percent",title:xt("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:xt("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(sr(t))}},{key:"usd",title:xt("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(sr(t))}},{key:"eur",title:xt("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(sr(t))}},{key:"date",title:xt("format.date"),type:"date",label:"26/09/2008",render:ur},{key:"time",title:xt("format.time"),type:"date",label:"15:59:00",render:ur},{key:"datetime",title:xt("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:ur},{key:"duration",title:xt("format.duration"),type:"date",label:"24:01:00",render:ur}],hr={};function pr(t){return pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(t)}function dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,br(r.key),r)}}function br(t){var e=function(t){if("object"!=pr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pr(e)?e:e+""}fr.forEach((function(t){hr[t.key]=t}));var vr={fillStyle:"#f4f5f8"},mr={fillStyle:"#fff",lineWidth:Wn,strokeStyle:"#e6e6e6"};function gr(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.cellRect(e,n),i=o.left,a=o.top,l=o.width,c=o.height;return new $n(i,a+r,l,c,5)}function wr(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.sortedRowMap,a=e.rows,l=e.cols;if(!a.isHide(n)&&!l.isHide(r)){var c=n;i.has(n)&&(c=i.get(n));var u=e.getCell(c,r);if(null!==u){var s=!1;"editable"in u&&!1===u.editable&&(s=!0);var f=e.getCellStyleOrDefault(c,r),h=gr(e,n,r,o);h.bgcolor=f.bgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h)),t.rect(h,(function(){var o="";o=e.settings.evalPaused?u.text||"":Qn.render(u.text||"",ir,(function(t,n){return e.getCellTextOrDefault(n,t)})),f.format&&(o=hr[f.format].render(o));var i=Object.assign({},f.font);i.size=function(t){for(var e=0;e<Xn.length;e+=1){var n=Xn[e];if(n.pt===t)return n.px}return t}(i.size),t.text(o,h,{align:f.align,valign:f.valign,font:i,color:f.color,strike:f.strike,underline:f.underline},f.textwrap),e.validations.getError(n,r)&&t.error(h),s&&t.frozen(h)}))}}}function xr(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var o=r.hrange();t.intersects(o)&&o.each((function(t,r){var o=gr(e,t,r);n.dropdown(o)}))}}function Sr(t,e,n,r,o){var i=this.draw,a=this.data;i.save(),i.translate(e,n).translate(r,o);var l=a.exceptRowSet,c=a.exceptRowTotalHeight(t.sri,t.eri);i.save(),i.translate(0,-c),t.each((function(t,e){wr(i,a,t,e)}),(function(t){return function(t){var e=l.has(t);if(e){var n=a.rows.getHeight(t);i.translate(0,-n)}return!e}(t)})),i.restore();var u=new Set;i.save(),i.translate(0,-c),a.eachMergesInView(t,(function(t){var e=t.sri,n=t.sci,r=t.eri;if(l.has(e)){if(!u.has(e)){u.add(e);var o=a.rows.sumHeight(e,r+1);i.translate(0,-o)}}else wr(i,a,e,n)})),i.restore(),xr.call(this,t),i.restore()}function Or(t,e,n,r){var o=this.draw;o.save(),o.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),o.restore()}function kr(t,e,n,r,o,i){var a=this,l=this.draw,c=this.data,u=e.h,s=e.w,h=i+r,p=o+n;l.save(),l.attr(vr),"all"!==t&&"left"!==t||l.fillRect(0,h,n,u),"all"!==t&&"top"!==t||l.fillRect(p,0,s,r);var d=c.selector.range,y=d.sri,b=d.sci,v=d.eri,m=d.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Vn(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Wn(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(c.rowEach(e.sri,e.eri,(function(t,e,r){var o=h+e,i=t;l.line([0,o],[n,o]),y<=i&&i<v+1&&Or.call(a,0,o,n,r),l.fillText(i+1,n/2,o+r/2),t>0&&c.rows.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([5,o+5],[n-5,o+5]),l.restore())})),l.line([0,u+h],[n,u+h]),l.line([n,h],[n,u+h])),"all"!==t&&"top"!==t||(c.colEach(e.sci,e.eci,(function(t,e,n){var o=p+e,i=t;l.line([o,0],[o,r]),b<=i&&i<m+1&&Or.call(a,o,0,n,r),l.fillText(f(i),o+n/2,r/2),t>0&&c.cols.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([o+5,5],[o+5,r-5]),l.restore())})),l.line([s+p,0],[s+p,r]),l.line([0,r],[s+p,r])),l.restore()}function jr(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}function Pr(t,e,n,r,o){var i=t.sri,a=t.sci,l=t.eri,c=t.eci,u=t.w,s=t.h,f=this.draw,h=this.data,p=h.settings;f.save(),f.attr(mr).translate(e+r,n+o),p.showGrid?(h.rowEach(i,l,(function(t,e,n){t!==i&&f.line([0,e],[u,e]),t===l&&f.line([0,e+n],[u,e+n])})),h.colEach(a,c,(function(t,e,n){t!==a&&f.line([e,0],[e,s]),t===c&&f.line([e+n,0],[e+n,s])})),f.restore()):f.restore()}function Er(t,e,n,r){var o=this.draw,i=this.data,a=i.viewWidth()-t,l=i.viewHeight()-e;o.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),o.line([0,r],[a,r]),o.line([n,0],[n,l]),o.restore()}var Tr=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Ln(e,n.viewWidth(),n.viewHeight()),this.data=n},e=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange(),i=t.freezeTotalWidth(),a=t.freezeTotalHeight(),l=t.scroll,c=l.x,u=l.y;Pr.call(this,o,n,r,i,a),Sr.call(this,o,n,r,-c,-u),kr.call(this,"all",o,n,r,i,a),jr.call(this,n,r);var s,f,h=(s=t.freeze,f=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(s,f)||function(t,e){if(t){if("string"==typeof t)return dr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dr(t,e):void 0}}(s,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=h[0],d=h[1];if(p>0||d>0){if(p>0){var y=o.clone();y.sri=0,y.eri=p-1,y.h=a,Pr.call(this,y,n,r,i,0),Sr.call(this,y,n,r,-c,0),kr.call(this,"top",y,n,r,i,0)}if(d>0){var b=o.clone();b.sci=0,b.eci=d-1,b.w=i,Pr.call(this,b,n,r,0,a),kr.call(this,"left",b,n,r,0,a),Sr.call(this,b,n,r,0,-u)}var v=t.freezeViewRange();Pr.call(this,v,n,r,0,0),kr.call(this,"all",v,n,r,0,0),Sr.call(this,v,n,r,0,0),Er.call(this,n,r,i,a)}}},{key:"clear",value:function(){this.draw.clear()}}],e&&yr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const Cr=Tr;function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function Ar(t){return function(t){if(Array.isArray(t))return Rr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Rr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dr(r.key),r)}}function Dr(t){var e=function(t){if("object"!=_r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_r(e)?e:e+""}var zr=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],Mr=["landscape","portrait"];function Br(t){return parseInt(96*t,10)}function Hr(t){"cancel"===t?this.el.hide():this.toPrint()}function Nr(t){var e=this.paper,n=t.target.value,r=zr[n];e.w=Br(r[1]),e.h=Br(r[2]),this.preview()}function Fr(t){var e=this.paper,n=t.target.value,r=Mr[n];e.orientation=r,this.preview()}var Wr=function(){return t=function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:Br(zr[0][1]),h:Br(zr[0][2]),padding:50,orientation:Mr[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=c("div","".concat(ce,"-print")).children(c("div","".concat(ce,"-print-bar")).children(c("div","-title").child("Print settings"),c("div","-right").children(c("div","".concat(ce,"-buttons")).children(new _n("cancel").on("click",Hr.bind(this,"cancel")),new _n("next","primary").on("click",Hr.bind(this,"next"))))),c("div","".concat(ce,"-print-content")).children(this.contentEl=c("div","-content"),c("div","-sider").child(c("form","").children(c("fieldset","").children(c("label","").child("".concat(wt("print.size"))),(n=c("select","")).children.apply(n,Ar(zr.map((function(t,e){return c("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",Nr.bind(this))),c("fieldset","").children(c("label","").child("".concat(wt("print.orientation"))),(r=c("select","")).children.apply(r,Ar(Mr.map((function(t,e){return c("option","").attr("value",e).child("".concat(wt("print.orientations")[e]))})))).on("change",Fr.bind(this))))))).hide()},(e=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,o=n.height,i=n.padding,a=r-2*i,l=o-2*i,u=e.contentRange(),s=parseInt(u.h/l,10)+1,f=a/u.w,h=i,p=i;f>1&&(h+=(a-u.w)/2);var d=0,y=0;this.contentEl.html(""),this.canvases=[];for(var b={sri:0,sci:0,eri:0,eci:0},v=function(){var n=0,i=0,a=c("div","".concat(ce,"-canvas-card")),s=c("canvas","".concat(ce,"-canvas"));t.canvases.push(s.el);var v=new Ln(s.el,r,o);for(v.save(),v.translate(h,p),f<1&&v.scale(f,f);d<=u.eri;d+=1){var m=e.rows.getHeight(d);if(!((n+=m)<l)){i=-(n-m);break}for(var g=0;g<=u.eci;g+=1)wr(v,e,d,g,y),b.eci=g}b.eri=d,v.restore(),v.save(),v.translate(h,p),f<1&&v.scale(f,f);var w=y;e.eachMergesInView(b,(function(t){var n=t.sri,r=t.sci;wr(v,e,n,r,w)})),v.restore(),b.sri=b.eri,b.sci=b.eci,y+=i,t.contentEl.child(c("div","".concat(ce,"-canvas-card-wraper")).child(a.child(s)))},m=0;m<s;m+=1)v();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=c("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(o),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)})),n.print()}}])&&Ir(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Vr(t){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(t)}function Ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function $r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qr(r.key),r)}}function qr(t){var e=function(t){if("object"!=Vr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vr(e)?e:e+""}var Lr=[{key:"copy",title:xt("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:xt("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:xt("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:xt("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:xt("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:xt("contextmenu.insertRow")},{key:"insert-column",title:xt("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:xt("contextmenu.deleteRow")},{key:"delete-column",title:xt("contextmenu.deleteColumn")},{key:"delete-cell-text",title:xt("contextmenu.deleteCellText")},{key:"hide",title:xt("contextmenu.hide")},{key:"divider"},{key:"validation",title:xt("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:xt("contextmenu.cellprintable")},{key:"cell-non-printable",title:xt("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:xt("contextmenu.celleditable")},{key:"cell-non-editable",title:xt("contextmenu.cellnoneditable")}];function Yr(t){var e=this;return"divider"===t.key?c("div","".concat(ce,"-item divider")):c("div","".concat(ce,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),c("div","label").child(t.label||""))}function Xr(){var t=this;return Lr.map((function(e){return Yr.call(t,e)}))}var Zr=function(){return t=function t(e){var n,r,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.menuItems=Xr.call(this),this.el=(n=c("div","".concat(ce,"-contextmenu"))).children.apply(n,(r=this.menuItems,function(t){if(Array.isArray(t))return Ur(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return Ur(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ur(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=o,this.setMode("range")},(e=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),oe(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset().width,o=this.viewFn(),i=o.height/2,a=t;o.width-t<=r&&(a-=r),n.css("left","".concat(a,"px")),e>i?n.css("bottom","".concat(o.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(o.height-e,"px")).css("bottom","auto"),ie(n)}}}])&&$r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Jr(t){return Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jr(t)}function Kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gr(r.key),r)}}function Gr(t){var e=function(t){if("object"!=Jr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jr(e)?e:e+""}var Qr=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=wt("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}},(e=[{key:"element",value:function(){var t=this,e=this.tip;return c("div","".concat(ce,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,o=n.top,i=n.width,a=n.height,l=c("div","".concat(ce,"-tooltip")).html(t).show();document.body.appendChild(l.el);var u=l.box();l.css("left","".concat(r+i/2-u.width/2,"px")).css("top","".concat(o+a+2,"px")),ne(e,"mouseleave",(function(){document.body.contains(l.el)&&document.body.removeChild(l.el)})),ne(e,"click",(function(){document.body.contains(l.el)&&document.body.removeChild(l.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&Kr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function to(t){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(t)}function eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,no(r.key),r)}}function no(t){var e=function(t){if("object"!=to(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=to(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==to(e)?e:e+""}function ro(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ro=function(){return!!t})()}function oo(){return oo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=io(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},oo.apply(null,arguments)}function io(t){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},io(t)}function ao(t,e){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ao(t,e)}var lo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=io(e),function(t,e){if(e&&("object"==to(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ro()?Reflect.construct(e,n||[],io(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}(e,t),n=e,r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},function(t,e,n){var r=oo(io(t.prototype),"element",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}],r&&eo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Qr);function co(t){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},co(t)}function uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,so(r.key),r)}}function so(t){var e=function(t){if("object"!=co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==co(e)?e:e+""}function fo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fo=function(){return!!t})()}function ho(t){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ho(t)}function po(t,e){return po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},po(t,e)}var yo=function(t){function e(t,n,r,o){var i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=function(t,e,n){return e=ho(e),function(t,e){if(e&&("object"==co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fo()?Reflect.construct(e,n||[],ho(t).constructor):e.apply(t,n))}(this,e,["div","".concat(ce,"-dropdown ").concat(o)])).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=c("div","".concat(ce,"-dropdown-title")).child(t):r&&a.title.addClass("arrow-left"),a.contentEl=c("div","".concat(ce,"-dropdown-content")).css("width",n).hide();for(var l=arguments.length,u=new Array(l>4?l-4:0),s=4;s<l;s++)u[s-4]=arguments[s];return(i=a).setContentChildren.apply(i,u),a.headerEl=c("div","".concat(ce,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,r?c("div","".concat(ce,"-icon arrow-right")).child(c("div","".concat(ce,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&po(t,e)}(e,t),n=e,r=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),ie(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),oe(this.parent())}}],r&&uo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(l);function bo(t){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(t)}function vo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function mo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,go(r.key),r)}}function go(t){var e=function(t){if("object"!=bo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=bo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bo(e)?e:e+""}function wo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wo=function(){return!!t})()}function xo(t){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xo(t)}function So(t,e){return So=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},So(t,e)}var Oo=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o,i=new Qe("align-".concat(n)),a=t.map((function(t){return(e="align-".concat(t),c("div","".concat(ce,"-item")).child(new Qe(e))).on("click",(function(){r.setTitle(t),r.change(t)}));var e}));return r=function(t,e,n){return e=xo(e),function(t,e){if(e&&("object"==bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wo()?Reflect.construct(e,n||[],xo(t).constructor):e.apply(t,n))}(this,e,[i,"auto",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return vo(t)}(o=a)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return vo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vo(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&So(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&mo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(yo);function ko(t){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(t)}function jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Po(r.key),r)}}function Po(t){var e=function(t){if("object"!=ko(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ko(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ko(e)?e:e+""}function Eo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Eo=function(){return!!t})()}function To(t){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},To(t)}function Co(t,e){return Co=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Co(t,e)}var _o=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=To(e),function(t,e){if(e&&("object"==ko(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Eo()?Reflect.construct(e,n||[],To(t).constructor):e.apply(t,n))}(this,e,["align","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Co(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Oo(["left","center","right"],t)}}])&&jo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function Ao(t){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(t)}function Ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Io(r.key),r)}}function Io(t){var e=function(t){if("object"!=Ao(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ao(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ao(e)?e:e+""}function Do(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Do=function(){return!!t})()}function zo(t){return zo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zo(t)}function Mo(t,e){return Mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mo(t,e)}var Bo=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=zo(e),function(t,e){if(e&&("object"==Ao(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Do()?Reflect.construct(e,n||[],zo(t).constructor):e.apply(t,n))}(this,e,["valign","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mo(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Oo(["top","middle","bottom"],t)}}])&&Ro(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function Ho(t){return Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(t)}function No(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fo(r.key),r)}}function Fo(t){var e=function(t){if("object"!=Ho(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ho(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ho(e)?e:e+""}function Wo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Wo=function(){return!!t})()}function Vo(){return Vo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Uo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Vo.apply(null,arguments)}function Uo(t){return Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uo(t)}function $o(t,e){return $o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$o(t,e)}var qo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Uo(e),function(t,e){if(e&&("object"==Ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wo()?Reflect.construct(e,n||[],Uo(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$o(t,e)}(e,t),n=e,r=[{key:"element",value:function(){var t=this,n=this.tag;return function(t,e,n){var r=Vo(Uo(t.prototype),"element",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]).child(new Qe(n)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}],r&&No(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Qr);function Lo(t){return Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lo(t)}function Yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xo(r.key),r)}}function Xo(t){var e=function(t){if("object"!=Lo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Lo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lo(e)?e:e+""}function Zo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Zo=function(){return!!t})()}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}function Ko(t,e){return Ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ko(t,e)}var Go=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Jo(e),function(t,e){if(e&&("object"==Lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zo()?Reflect.construct(e,n||[],Jo(t).constructor):e.apply(t,n))}(this,e,["autofilter"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ko(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(){}}])&&Yo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(qo);function Qo(t){return Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qo(t)}function ti(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ti=function(){return!!t})()}function ei(t){return ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ei(t)}function ni(t,e){return ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ni(t,e)}var ri=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ei(e),function(t,e){if(e&&("object"==Qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ti()?Reflect.construct(e,n||[],ei(t).constructor):e.apply(t,n))}(this,e,["font-bold","Ctrl+B"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ni(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function oi(t){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oi(t)}function ii(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ii=function(){return!!t})()}function ai(t){return ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ai(t)}function li(t,e){return li=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},li(t,e)}var ci=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ai(e),function(t,e){if(e&&("object"==oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ii()?Reflect.construct(e,n||[],ai(t).constructor):e.apply(t,n))}(this,e,["font-italic","Ctrl+I"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&li(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function si(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(si=function(){return!!t})()}function fi(t){return fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fi(t)}function hi(t,e){return hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hi(t,e)}var pi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=fi(e),function(t,e){if(e&&("object"==ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,si()?Reflect.construct(e,n||[],fi(t).constructor):e.apply(t,n))}(this,e,["strike","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hi(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function di(t){return di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},di(t)}function yi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yi=function(){return!!t})()}function bi(t){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bi(t)}function vi(t,e){return vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vi(t,e)}var mi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=bi(e),function(t,e){if(e&&("object"==di(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yi()?Reflect.construct(e,n||[],bi(t).constructor):e.apply(t,n))}(this,e,["underline","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vi(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function gi(t){return gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gi(t)}function wi(t){return function(t){if(Array.isArray(t))return xi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return xi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ki(r.key),r)}}function Oi(t,e,n){return e&&Si(t.prototype,e),n&&Si(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ki(t){var e=function(t){if("object"!=gi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=gi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gi(e)?e:e+""}var ji=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Pi=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Ei=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Ti(t){var e=this;return c("td","").child(c("div","".concat(ce,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var Ci=Oi((function t(){var e,n,r,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=c("div","".concat(ce,"-color-palette")),this.change=function(){};var i=c("table","").children((e=c("tbody","")).children.apply(e,[(n=c("tr","".concat(ce,"-theme-color-placeholders"))).children.apply(n,wi(ji.map((function(t){return Ti.call(o,t)}))))].concat(wi(Pi.map((function(t){var e;return(e=c("tr","".concat(ce,"-theme-colors"))).children.apply(e,wi(t.map((function(t){return Ti.call(o,t)}))))}))),[(r=c("tr","".concat(ce,"-standard-colors"))).children.apply(r,wi(Ei.map((function(t){return Ti.call(o,t)}))))])));this.el.child(i)}));function _i(t){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_i(t)}function Ai(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ri(r.key),r)}}function Ri(t){var e=function(t){if("object"!=_i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_i(e)?e:e+""}function Ii(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ii=function(){return!!t})()}function Di(t){return Di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Di(t)}function zi(t,e){return zi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zi(t,e)}var Mi=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new Qe(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),i=new Ci;return i.change=function(t){r.setTitle(t),r.change(t)},r=function(t,e,n){return e=Di(e),function(t,e){if(e&&("object"==_i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ii()?Reflect.construct(e,n||[],Di(t).constructor):e.apply(t,n))}(this,e,[o,"auto",!1,"bottom-left",i.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zi(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Ai(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(yo);function Bi(t){return Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bi(t)}function Hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ni(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ni=function(){return!!t})()}function Fi(t){return Fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fi(t)}function Wi(t,e){return Wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wi(t,e)}var Vi=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Ui=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r,o=new Qe("line-type"),i=0,a=Vi.map((function(e,r){return c("div","".concat(ce,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){a[i].toggle("checked"),a[r].toggle("checked"),i=r,n.hide(),n.change(e)})).child(c("div","".concat(ce,"-line-type")).html(e[1]))}));return n=function(t,e,n){return e=Fi(e),function(t,e){if(e&&("object"==Bi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ni()?Reflect.construct(e,n||[],Fi(t).constructor):e.apply(t,n))}(this,e,[o,"auto",!1,"bottom-left"].concat(function(t){if(Array.isArray(t))return Hi(t)}(r=a)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return Hi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hi(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wi(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(yo);function $i(t){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$i(t)}function qi(t){return function(t){if(Array.isArray(t))return Yi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Li(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(t,e){if(t){if("string"==typeof t)return Yi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yi(t,e):void 0}}function Yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ji(r.key),r)}}function Zi(t,e,n){return e&&Xi(t.prototype,e),n&&Xi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ji(t){var e=function(t){if("object"!=$i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$i(e)?e:e+""}function Ki(){var t;return c("table","").child((t=c("tbody","")).children.apply(t,arguments))}function Gi(t){var e=this;return c("td","").child(c("div","".concat(ce,"-border-palette-cell")).child(new Qe("border-".concat(t))).on("click",(function(){e.mode=t;var n=e.mode,r=e.style,o=e.color;e.change({mode:n,style:r,color:o})})))}var Qi=Zi((function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Mi("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new Ui(this.style),this.ddType.change=function(t){var e,n,o=(e=t,n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,n)||Li(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];r.style=o},this.el=c("div","".concat(ce,"-border-palette"));var o=Ki(c("tr","").children(c("td","".concat(ce,"-border-palette-left")).child(Ki((e=c("tr","")).children.apply(e,qi(["all","inside","horizontal","vertical","outside"].map((function(t){return Gi.call(r,t)})))),(n=c("tr","")).children.apply(n,qi(["left","top","right","bottom","none"].map((function(t){return Gi.call(r,t)})))))),c("td","".concat(ce,"-border-palette-right")).children(c("div","".concat(ce,"-toolbar-btn")).child(this.ddColor.el),c("div","".concat(ce,"-toolbar-btn")).child(this.ddType.el))));this.el.child(o)}));function ta(t){return ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ta(t)}function ea(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ea=function(){return!!t})()}function na(t){return na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},na(t)}function ra(t,e){return ra=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ra(t,e)}var oa=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Qe("border-all"),r=new Qi;return r.change=function(e){t.change(e),t.hide()},t=function(t,e,n){return e=na(e),function(t,e){if(e&&("object"==ta(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ea()?Reflect.construct(e,n||[],na(t).constructor):e.apply(t,n))}(this,e,[n,"auto",!1,"bottom-left",r.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ra(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(yo);function ia(t){return ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ia(t)}function aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,la(r.key),r)}}function la(t){var e=function(t){if("object"!=ia(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ia(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ia(e)?e:e+""}function ca(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ca=function(){return!!t})()}function ua(t){return ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ua(t)}function sa(t,e){return sa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sa(t,e)}var fa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ua(e),function(t,e){if(e&&("object"==ia(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ca()?Reflect.construct(e,n||[],ua(t).constructor):e.apply(t,n))}(this,e,["border"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sa(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){return new oa}}])&&aa(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function ha(t){return ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ha(t)}function pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,da(r.key),r)}}function da(t){var e=function(t){if("object"!=ha(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ha(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ha(e)?e:e+""}function ya(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ya=function(){return!!t})()}function ba(){return ba="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=va(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ba.apply(null,arguments)}function va(t){return va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},va(t)}function ma(t,e){return ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ma(t,e)}var ga=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=va(e),function(t,e){if(e&&("object"==ha(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ya()?Reflect.construct(e,n||[],va(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ma(t,e)}(e,t),n=e,r=[{key:"element",value:function(){var t=this;return function(t,e,n){var r=ba(va(t.prototype),"element",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]).child(new Qe(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}],r&&pa(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Qr);function wa(t){return wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wa(t)}function xa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(xa=function(){return!!t})()}function Sa(t){return Sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sa(t)}function Oa(t,e){return Oa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Oa(t,e)}var ka=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Sa(e),function(t,e){if(e&&("object"==wa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xa()?Reflect.construct(e,n||[],Sa(t).constructor):e.apply(t,n))}(this,e,["clearformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oa(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(ga);function ja(t){return ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ja(t)}function Pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ea(r.key),r)}}function Ea(t){var e=function(t){if("object"!=ja(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ja(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ja(e)?e:e+""}function Ta(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ta=function(){return!!t})()}function Ca(t){return Ca=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ca(t)}function _a(t,e){return _a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_a(t,e)}var Aa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ca(e),function(t,e){if(e&&("object"==ja(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ta()?Reflect.construct(e,n||[],Ca(t).constructor):e.apply(t,n))}(this,e,["paintformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_a(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(){}}])&&Pa(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(qo);function Ra(t){return Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ra(t)}function Ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Da(r.key),r)}}function Da(t){var e=function(t){if("object"!=Ra(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ra(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ra(e)?e:e+""}function za(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(za=function(){return!!t})()}function Ma(t){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ma(t)}function Ba(t,e){return Ba=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ba(t,e)}var Ha=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ma(e),function(t,e){if(e&&("object"==Ra(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,za()?Reflect.construct(e,n||[],Ma(t).constructor):e.apply(t,n))}(this,e,["color",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ba(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Mi(t,e)}}])&&Ia(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function Na(t){return Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Na(t)}function Fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wa(r.key),r)}}function Wa(t){var e=function(t){if("object"!=Na(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Na(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Na(e)?e:e+""}function Va(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Va=function(){return!!t})()}function Ua(t){return Ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ua(t)}function $a(t,e){return $a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$a(t,e)}var qa=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ua(e),function(t,e){if(e&&("object"==Na(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Va()?Reflect.construct(e,n||[],Ua(t).constructor):e.apply(t,n))}(this,e,["bgcolor",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$a(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Mi(t,e)}}])&&Fa(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function La(t){return La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},La(t)}function Ya(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Xa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xa=function(){return!!t})()}function Za(t){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Za(t)}function Ja(t,e){return Ja=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ja(t,e)}var Ka=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r=Xn.map((function(e){return c("div","".concat(ce,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=function(t,e,n){return e=Za(e),function(t,e){if(e&&("object"==La(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xa()?Reflect.construct(e,n||[],Za(t).constructor):e.apply(t,n))}(this,e,["10","60px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return Ya(t)}(n=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Ya(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ya(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ja(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(yo);function Ga(t){return Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(t)}function Qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tl(r.key),r)}}function tl(t){var e=function(t){if("object"!=Ga(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ga(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ga(e)?e:e+""}function el(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(el=function(){return!!t})()}function nl(t){return nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nl(t)}function rl(t,e){return rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rl(t,e)}var ol=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=nl(e),function(t,e){if(e&&("object"==Ga(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,el()?Reflect.construct(e,n||[],nl(t).constructor):e.apply(t,n))}(this,e,["font-size"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rl(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Ka}}])&&Qa(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function il(t){return il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(t)}function al(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ll(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ll=function(){return!!t})()}function cl(t){return cl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cl(t)}function ul(t,e){return ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ul(t,e)}var sl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r=Yn.map((function(e){return c("div","".concat(ce,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=function(t,e,n){return e=cl(e),function(t,e){if(e&&("object"==il(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ll()?Reflect.construct(e,n||[],cl(t).constructor):e.apply(t,n))}(this,e,[Yn[0].title,"160px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return al(t)}(n=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return al(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?al(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ul(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(yo);function fl(t){return fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(t)}function hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pl(r.key),r)}}function pl(t){var e=function(t){if("object"!=fl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=fl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fl(e)?e:e+""}function dl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(dl=function(){return!!t})()}function yl(t){return yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yl(t)}function bl(t,e){return bl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bl(t,e)}var vl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=yl(e),function(t,e){if(e&&("object"==fl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dl()?Reflect.construct(e,n||[],yl(t).constructor):e.apply(t,n))}(this,e,["font-name"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bl(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new sl}}])&&hl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function ml(t){return ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(t)}function gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xl(r.key),r)}}function xl(t){var e=function(t){if("object"!=ml(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ml(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ml(e)?e:e+""}function Sl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Sl=function(){return!!t})()}function Ol(t){return Ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ol(t)}function kl(t,e){return kl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kl(t,e)}var jl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r=fr.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map((function(e){var n=c("div","".concat(ce,"-item"));return"divider"===e.key?n.addClass("divider"):(n.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&n.child(c("div","label").html(e.label))),n})),t=function(t,e,n){return e=Ol(e),function(t,e){if(e&&("object"==ml(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Sl()?Reflect.construct(e,n||[],Ol(t).constructor):e.apply(t,n))}(this,e,["Normal","220px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return gl(t)}(n=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return gl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kl(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<fr.length;e+=1)fr[e].key===t&&this.title.html(fr[e].title());this.hide()}}])&&wl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(yo);function Pl(t){return Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(t)}function El(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tl(r.key),r)}}function Tl(t){var e=function(t){if("object"!=Pl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pl(e)?e:e+""}function Cl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Cl=function(){return!!t})()}function _l(t){return _l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_l(t)}function Al(t,e){return Al=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Al(t,e)}var Rl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=_l(e),function(t,e){if(e&&("object"==Pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Cl()?Reflect.construct(e,n||[],_l(t).constructor):e.apply(t,n))}(this,e,["format"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Al(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new jl}}])&&El(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function Il(t){return Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(t)}function Dl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function zl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zl=function(){return!!t})()}function Ml(t){return Ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ml(t)}function Bl(t,e){return Bl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bl(t,e)}var Hl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r=rr.map((function(e){return c("div","".concat(ce,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=function(t,e,n){return e=Ml(e),function(t,e){if(e&&("object"==Il(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zl()?Reflect.construct(e,n||[],Ml(t).constructor):e.apply(t,n))}(this,e,[new Qe("formula"),"180px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return Dl(t)}(n=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Dl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dl(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bl(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(yo);function Nl(t){return Nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(t)}function Fl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wl(r.key),r)}}function Wl(t){var e=function(t){if("object"!=Nl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Nl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nl(e)?e:e+""}function Vl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Vl=function(){return!!t})()}function Ul(t){return Ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ul(t)}function $l(t,e){return $l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$l(t,e)}var ql=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ul(e),function(t,e){if(e&&("object"==Nl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vl()?Reflect.construct(e,n||[],Ul(t).constructor):e.apply(t,n))}(this,e,["formula"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$l(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Hl}}])&&Fl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(lo);function Ll(t){return Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(t)}function Yl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yl=function(){return!!t})()}function Xl(t){return Xl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xl(t)}function Zl(t,e){return Zl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zl(t,e)}var Jl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Xl(e),function(t,e){if(e&&("object"==Ll(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yl()?Reflect.construct(e,n||[],Xl(t).constructor):e.apply(t,n))}(this,e,["freeze"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zl(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function Kl(t){return Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(t)}function Gl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ql(r.key),r)}}function Ql(t){var e=function(t){if("object"!=Kl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Kl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kl(e)?e:e+""}function tc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(tc=function(){return!!t})()}function ec(t){return ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ec(t)}function nc(t,e){return nc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nc(t,e)}var rc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ec(e),function(t,e){if(e&&("object"==Kl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,tc()?Reflect.construct(e,n||[],ec(t).constructor):e.apply(t,n))}(this,e,["merge"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nc(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Gl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(qo);function oc(t){return oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oc(t)}function ic(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ic=function(){return!!t})()}function ac(t){return ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ac(t)}function lc(t,e){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lc(t,e)}var cc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ac(e),function(t,e){if(e&&("object"==oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ic()?Reflect.construct(e,n||[],ac(t).constructor):e.apply(t,n))}(this,e,["redo","Ctrl+Y"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lc(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(ga);function uc(t){return uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(t)}function sc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sc=function(){return!!t})()}function fc(t){return fc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fc(t)}function hc(t,e){return hc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hc(t,e)}var pc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=fc(e),function(t,e){if(e&&("object"==uc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,sc()?Reflect.construct(e,n||[],fc(t).constructor):e.apply(t,n))}(this,e,["undo","Ctrl+Z"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hc(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(ga);function dc(t){return dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(t)}function yc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yc=function(){return!!t})()}function bc(t){return bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bc(t)}function vc(t,e){return vc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vc(t,e)}var mc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=bc(e),function(t,e){if(e&&("object"==dc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yc()?Reflect.construct(e,n||[],bc(t).constructor):e.apply(t,n))}(this,e,["print","Ctrl+P"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vc(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(ga);function gc(t){return gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gc(t)}function wc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wc=function(){return!!t})()}function xc(t){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xc(t)}function Sc(t,e){return Sc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sc(t,e)}var Oc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=xc(e),function(t,e){if(e&&("object"==gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wc()?Reflect.construct(e,n||[],xc(t).constructor):e.apply(t,n))}(this,e,["textwrap"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sc(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(qo);function kc(t){return kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(t)}function jc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ec(r.key),r)}}function Pc(t,e,n){return e&&jc(t.prototype,e),n&&jc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ec(t){var e=function(t){if("object"!=kc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=kc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kc(e)?e:e+""}function Tc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cc(t,e,n){return e=Ac(e),function(t,e){if(e&&("object"==kc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_c()?Reflect.construct(e,n||[],Ac(t).constructor):e.apply(t,n))}function _c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_c=function(){return!!t})()}function Ac(t){return Ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ac(t)}function Rc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ic(t,e)}function Ic(t,e){return Ic=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ic(t,e)}var Dc=function(t){function e(){var t;Tc(this,e);var n=new Qe("ellipsis"),r=c("div","".concat(ce,"-toolbar-more"));return(t=Cc(this,e,[n,"auto",!1,"bottom-right",r])).moreBtns=r,t.contentEl.css("max-width","420px"),t}return Rc(e,t),Pc(e)}(yo),zc=function(t){function e(){var t;return Tc(this,e),(t=Cc(this,e,["more"])).el.hide(),t}return Rc(e,t),Pc(e,[{key:"dropdown",value:function(){return new Dc}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])}(lo);function Mc(t){return Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(t)}function Bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hc(r.key),r)}}function Hc(t){var e=function(t){if("object"!=Mc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Mc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mc(e)?e:e+""}function Nc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Fc(){return c("div","".concat(ce,"-toolbar-divider"))}function Wc(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var n=e.el,r=n.box(),o=n.computedStyle(),i=o.marginLeft,a=o.marginRight;t.btns2.push([n,r.width+parseInt(i,10)+parseInt(a,10)])}));else{var n=e.box(),r=e.computedStyle(),o=r.marginLeft,i=r.marginRight;t.btns2.push([e,n.width+parseInt(o,10)+parseInt(i,10)])}}))}function Vc(){var t,e,n=this.el,r=this.btns,o=this.moreEl,i=this.btns2,a=o.dd,l=a.moreBtns,c=a.contentEl;n.css("width","".concat(this.widthFn(),"px"));var u=n.box(),s=160,f=12,h=[],p=[];i.forEach((function(t,e){var n,r,o=(r=2,function(t){if(Array.isArray(t))return t}(n=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,r)||function(t,e){if(t){if("string"==typeof t)return Nc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nc(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],l=o[1];s+=l,e===i.length-1||s<u.width?h.push(a):(f+=l,p.push(a))})),(t=r.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,p),c.css("width","".concat(f,"px")),p.length>0?o.show():o.hide()}function Uc(t){var e=this,n=new Qr;n.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),n.tip=t.tip||"";var r=t.el;if(t.icon&&(r=c("img").attr("src",t.icon)),r){var o=c("div","".concat(ce,"-icon"));o.child(r),n.el.child(o)}return n}var $c=function(){return t=function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=o;var i=e.defaultStyle();this.items=[[this.undoEl=new pc,this.redoEl=new cc,new mc,this.paintformatEl=new Aa,this.clearformatEl=new ka],Fc(),[this.formatEl=new Rl],Fc(),[this.fontEl=new vl,this.fontSizeEl=new ol],Fc(),[this.boldEl=new ri,this.italicEl=new ci,this.underlineEl=new mi,this.strikeEl=new pi,this.textColorEl=new Ha(i.color)],Fc(),[this.fillColorEl=new qa(i.bgcolor),this.borderEl=new fa,this.mergeEl=new rc],Fc(),[this.alignEl=new _o(i.align),this.valignEl=new Bo(i.valign),this.textwrapEl=new Oc],Fc(),[this.freezeEl=new Jl,this.autofilterEl=new Go,this.formulaEl=new ql]];var a=e.settings.extendToolbar,l=void 0===a?{}:a;if(l.left&&l.left.length>0){this.items.unshift(Fc());var u=l.left.map(Uc.bind(this));this.items.unshift(u)}if(l.right&&l.right.length>0){this.items.push(Fc());var s=l.right.map(Uc.bind(this));this.items.push(s)}this.items.push([this.moreEl=new zc]),this.el=c("div","".concat(ce,"-toolbar")),this.btns=c("div","".concat(ce,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){r.btns.child(t.el),t.change=function(){r.change.apply(r,arguments)}})):r.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){Wc.call(r),Vc.call(r)}),0),ne(window,"resize",(function(){Vc.call(r)})))},(e=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Bc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function qc(t){return qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(t)}function Lc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Yc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xc(r.key),r)}}function Xc(t){var e=function(t){if("object"!=qc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qc(e)?e:e+""}var Zc=function(){return t=function t(e,n){var r,o,i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=c("div","".concat(ce,"-modal")).css("width",a).children(c("div","".concat(ce,"-modal-header")).children(new Qe("close").on("click.stop",(function(){return i.hide()})),this.title),(r=c("div","".concat(ce,"-modal-content"))).children.apply(r,(o=n,function(t){if(Array.isArray(t))return Lc(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return Lc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lc(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).hide()},(e=[{key:"show",value:function(){var t=this;this.dimmer=c("div","".concat(ce,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,r=e.height,o=document.documentElement,i=o.clientHeight,a=o.clientWidth;this.el.offset({left:(a-n)/2,top:(i-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},ne(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),re(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&Yc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Jc(t){return Jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(t)}function Kc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gc(r.key),r)}}function Gc(t){var e=function(t){if("object"!=Jc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jc(e)?e:e+""}var Qc=function(){return t=function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=c("div","".concat(ce,"-form-input")),this.input=c("input","").css("width",e).on("input",(function(t){return r.vchange(t)})).attr("placeholder",n),this.el.child(this.input)},(e=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Kc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function tu(t){return tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(t)}function eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nu(r.key),r)}}function nu(t){var e=function(t){if("object"!=tu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=tu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tu(e)?e:e+""}var ru=function(){return t=function t(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=i,this.vchange=function(){},this.el=c("div","".concat(ce,"-form-select")),this.suggest=new Le(n.map((function(t){return{key:t,title:o.getTitle(t)}})),(function(t){o.itemClick(t.key),a(t.key),o.vchange(t.key)}),r,this.el),this.el.children(this.itemEl=c("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return o.show()}))},(e=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&eu(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ou(t){return ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(t)}function iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,au(r.key),r)}}function au(t){var e=function(t){if("object"!=ou(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ou(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ou(e)?e:e+""}var lu={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},cu=function(){return t=function t(e,n,r,o){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=c("label","label").css("width","".concat(o,"px")).html(r)),this.tip=c("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return i.validate()},this.el=c("div","".concat(ce,"-form-field")).children(this.label,e.el,this.tip)},(e=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,o=t.val();return e.required&&/^\s*$/.test(o)?(n.html(wt("validation.required")),r.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||lu[e.type]).test(o)?(r.removeClass("error"),!0):(n.html(wt("validation.notMatch")),r.addClass("error"),!1)}}])&&iu(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function uu(t){return uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(t)}function su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fu(r.key),r)}}function fu(t){var e=function(t){if("object"!=uu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=uu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==uu(e)?e:e+""}function hu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hu=function(){return!!t})()}function pu(t){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pu(t)}function du(t,e){return du=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},du(t,e)}var yu=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new cu(new ru("cell",["cell"],"100%",(function(t){return wt("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(wt("dataValidation.range"),":"),100),r=new cu(new Qc("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),o=new cu(new ru("list",["list","number","date","phone","email"],"100%",(function(t){return wt("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(wt("dataValidation.criteria"),":"),100),i=new cu(new ru("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return wt("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new cu(new Qc("70px","10"),{required:!0}).hide(),l=new cu(new Qc("70px","100"),{required:!0,type:"number"}).hide(),u=new cu(new Qc("120px","a,b,c"),{required:!0}),s=new cu(new Qc("70px","10"),{required:!0,type:"number"}).hide();return(t=function(t,e,n){return e=pu(e),function(t,e){if(e&&("object"==uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hu()?Reflect.construct(e,n||[],pu(t).constructor):e.apply(t,n))}(this,e,[wt("contextmenu.validation"),[c("div","".concat(ce,"-form-fields")).children(n.el,r.el),c("div","".concat(ce,"-form-fields")).children(o.el,i.el,a.el,l.el,s.el,u.el),c("div","".concat(ce,"-buttons")).children(new _n("cancel").on("click",(function(){return t.btnClick("cancel")})),new _n("remove").on("click",(function(){return t.btnClick("remove")})),new _n("save","primary").on("click",(function(){return t.btnClick("save")})))]])).mf=n,t.rf=r,t.cf=o,t.of=i,t.minvf=a,t.maxvf=l,t.vf=s,t.svf=u,t.change=function(){},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&du(t,e)}(e,t),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,o=this.vf,i=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),o.hide(),i.hide()):("list"===t?i.show():i.hide(),o.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var o=this.cf.val();r.rule.type=o,"date"===o?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var o=this.mf.val(),i=this.rf.val(),a=this.cf.val(),l=this.of.val(),c=this.svf.val();"number"!==a&&"date"!==a||(c="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",o,i,{type:a,operator:l,required:!1,value:c}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,o=this.of,i=this.svf,a=this.vf,l=this.minvf,c=this.maxvf,u=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,p=f.operator,d=f.value;e.val(u||"cell"),n.val(s),r.val(h),o.val(p),Array.isArray(d)?(l.val(d[0]),c.val(d[1])):(i.val(d||""),a.val(d||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&su(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Zc);function bu(t){return bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(t)}function vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mu(r.key),r)}}function mu(t){var e=function(t){if("object"!=bu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=bu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bu(e)?e:e+""}function gu(t){return c("div","".concat(ce,"-item ").concat(t))}function wu(t){var e=this;return gu("state").child(wt("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function xu(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach((function(o,i){var a=t[o],l=r.includes(o)?"checked":"";n.child(c("div","".concat(ce,"-item state ").concat(l)).on("click.stop",(function(){return e.filterClick(i,o)})).children(""===o?wt("filter.empty"):o,c("div","label").html("(".concat(a,")"))))}))}function Su(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var Ou=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=c("div","".concat(ce,"-body")),this.filterhEl=c("div","".concat(ce,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=c("div","".concat(ce,"-sort-filter")).children(this.sortAscEl=wu.call(this,"asc"),this.sortDescEl=wu.call(this,"desc"),gu("divider"),c("div","".concat(ce,"-filter")).children(this.filterhEl,this.filterbEl),c("div","".concat(ce,"-buttons")).children(new _n("cancel").on("click",(function(){return e.btnClick("cancel")})),new _n("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]},(e=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,o=this.values,i=n.children();"all"===e?i.length===r.length?(this.filterValues=[],i.forEach((function(t){return c(t).checked(!1)}))):(this.filterValues=Array.from(o),i.forEach((function(t){return c(t).checked(!0)}))):c(i[t]).toggle("checked")?r.push(e):r.splice(r.findIndex((function(t){return t===e})),1),Su.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var o=this.sortAscEl,i=this.sortDescEl;null!==r?(this.sort=r.order,o.checked(r.asc()),i.checked(r.desc())):(this.sortDesc=null,o.checked(!1),i.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),xu.call(this,e,n),Su.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;ie(this.el,(function(){n<=0&&e.hide(),n-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),oe(this.el)}}])&&vu(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ku(t,e){var n=c("div","".concat(ce,"-toast")),r=c("div","".concat(ce,"-dimmer active"));n.children(c("div","".concat(ce,"-toast-header")).children(new Qe("close").on("click.stop",(function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)})),t),c("div","".concat(ce,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var o=n.box(),i=o.width,a=o.height,l=document.documentElement,u=l.clientHeight,s=l.clientWidth;n.offset({left:(s-i)/2,top:(u-a)/3})}function ju(t){return ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(t)}function Pu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Eu(r.key),r)}}function Eu(t){var e=function(t){if("object"!=ju(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ju(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ju(e)?e:e+""}function Tu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Cu(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cu(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _u(t,e){var n,r=this;return function(){for(var o=r,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var c=a;n||(n=setTimeout((function(){n=null,t.apply(o,c)}),e))}}function Au(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),o=r.l,i=r.t,a=r.left,l=r.top,c=r.width,u=r.height,s=this.getTableOffset();if(Math.abs(a)+c>s.width)n.move({left:o+c-s.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:o-1-f})}if(Math.abs(l)+u>s.height)e.move({top:i+u-s.height-1});else{var h=t.freezeTotalHeight();l<h&&e.move({top:i-1-h})}}function Ru(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var i=this.table,a=this.selector,l=this.toolbar,c=this.data,u=this.contextMenu,s=c.getCell(e,n);t?(a.setEnd(e,n,o),this.trigger("cells-selected",s,a.range)):(a.set(e,n,r),this.trigger("cell-selected",s,e,n)),u.setMode(-1===e||-1===n?"row-col":"range"),l.reset(),i.render()}}function Iu(t,e){var n=this.selector,r=this.data,o=r.rows,i=r.cols,a=Tu(n.indexes,2),l=a[0],c=a[1],u=n.range,s=u.eri,f=u.eci;if(t){var h=Tu(n.moveIndexes,2);l=h[0],c=h[1]}"left"===e?c>0&&(c-=1):"right"===e?(f!==c&&(c=f),c<i.len-1&&(c+=1)):"up"===e?l>0&&(l-=1):"down"===e?(s!==l&&(l=s),l<o.len-1&&(l+=1)):"row-first"===e?c=0:"row-last"===e?c=i.len-1:"col-first"===e?l=0:"col-last"===e&&(l=o.len-1),t&&(n.moveIndexes=[l,c]),Ru.call(this,t,l,c),Au.call(this)}function Du(t){if(0===t.buttons&&t.target.className!=="".concat(ce,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,o=this.colResizer,i=this.tableEl,a=this.data,l=a.rows,c=a.cols;if(e>c.indexWidth&&n>l.height)return r.hide(),void o.hide();var u=i.box(),s=a.getCellRectByXY(t.offsetX,t.offsetY);s.ri>=0&&-1===s.ci?(s.width=c.indexWidth,r.show(s,{width:u.width}),l.isHide(s.ri-1)?r.showUnhide(s.ri):r.hideUnhide()):r.hide(),-1===s.ri&&s.ci>=0?(s.height=l.height,o.show(s,{height:u.height}),c.isHide(s.ci-1)?o.showUnhide(s.ci):o.hideUnhide()):o.hide()}}function zu(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,o=e.scroll().top,i=n.scroll().left,a=r.rows,l=r.cols,c=t.deltaY,u=t.deltaX,s=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var i=s(n,(function(t){return a.getHeight(t)}));e.move({top:o+i-1})}}else{var l=r.scroll.ri-1;if(l>=0){var c=s(l,(function(t){return a.getHeight(t)}));e.move({top:0===l?0:o-c})}}},h=Math.abs(c),p=Math.abs(u),d=Math.max(h,p);/Firefox/i.test(window.navigator.userAgent)&&_u(f(t.detail),50),d===p&&_u(function(t){if(t>0){var e=r.scroll.ci+1;if(e<l.len){var o=s(e,(function(t){return l.getWidth(t)}));n.move({left:i+o-1})}}else{var a=r.scroll.ci-1;if(a>=0){var c=s(a,(function(t){return l.getWidth(t)}));n.move({left:0===a?0:i-c})}}}(u),50),d===h&&_u(f(c),50)}function Mu(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,o=n.scroll().top,i=r.scroll().left;"left"===t||"right"===t?r.move({left:i-e}):"up"!==t&&"down"!==t||n.move({top:o-e})}function Bu(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function Hu(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function Nu(){var t=this.selector,e=this.data,n=this.editor,r=Tu(e.freeze,2),o=r[0],i=r[1];if(o>0||i>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();n.setFreezeLengths(a,l)}t.resetAreaOffset()}function Fu(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,o=this.toolbar,i=this.selector,a=this.el,l=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),n.offset(l),a.css("width","".concat(c.width,"px")),Bu.call(this),Hu.call(this),Nu.call(this),r.render(),o.reset(),i.reset()}function Wu(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Vu(t){var e=this.data,n=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),n.showClipboard())}function Uu(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function $u(t,e){var n=this,r=this.data;if("read"!==r.settings.mode)if(r.clipboard.isClear())r.pasteFromSystemClipboard((function(){return Fu.call(n)}),(function(t){n.trigger("pasted-clipboard",t)}));else if(r.paste(t,(function(t){return ku("Tip",t)})))Fu.call(this);else if(e){var o=e.clipboardData.getData("text/plain");this.data.pasteFromText(o),Fu.call(this)}}function qu(){this.data.hideRowsOrCols(),Fu.call(this)}function Lu(t,e){this.data.unhideRowsOrCols(t,e),Fu.call(this)}function Yu(){this.data.autofilter(),Fu.call(this)}function Xu(){var t=this.toolbar;t.paintformatActive()&&($u.call(this,"format"),Wu.call(this),t.paintformatToggle())}function Zu(t){var e=this,n=this.selector,r=this.data,o=this.table,i=this.sortFilter,a=t.offsetX,l=t.offsetY,c=t.target.className==="".concat(ce,"-selector-corner"),u=r.getCellRectByXY(a,l),s=u.left,f=u.top,h=u.width,p=u.height,d=u.ri,y=u.ci,b=r.autoFilter;if(b.includes(d,y)&&s+h-20<a&&f+p-20<l){var v=b.items(y,(function(t,e){return r.rows.getCell(t,e)}));return i.hide(),i.set(y,v,b.getFilter(y),b.getSort(y)),void i.setOffset({left:s,top:f+p+2})}t.shiftKey||(c?n.showAutofill(d,y):Ru.call(this,!1,d,y),ae(window,(function(t){var o=r.getCellRectByXY(t.offsetX,t.offsetY);d=o.ri,y=o.ci,c?n.showAutofill(d,y):1!==t.buttons||t.shiftKey||Ru.call(e,!0,d,y,!0,!0)}),(function(){c&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",(function(t){return ku("Tip",t)}))&&o.render(),n.hideAutofill(),Xu.call(e)}))),c||1!==t.buttons||t.shiftKey&&Ru.call(this,!0,d,y)}function Ju(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function Ku(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(Ju.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Wu.call(this))}function Gu(t){var e=this,n=this.data,r=this.table,o=this.selector;n.scrolly(t,(function(){o.resetBRLAreaOffset(),Ju.call(e),r.render()}))}function Qu(t){var e=this,n=this.data,r=this.table,o=this.selector;n.scrollx(t,(function(){o.resetBRTAreaOffset(),Ju.call(e),r.render()}))}function ts(t,e){var n=t.ri,r=this.table,o=this.selector,i=this.data,a=o.range,l=a.sri,c=a.eri;if(n>=l&&n<=c)for(var u=l;u<=c;u+=1)i.rows.setHeight(u,e);else i.rows.setHeight(n,e);r.render(),o.resetAreaOffset(),Bu.call(this),Ju.call(this)}function es(t,e){var n=t.ci,r=this.table,o=this.selector,i=this.data,a=o.range,l=a.sci,c=a.eci;if(n>=l&&n<=c)for(var u=l;u<=c;u+=1)i.cols.setWidth(u,e);else i.cols.setWidth(n,e);r.render(),o.resetAreaOffset(),Hu.call(this),Ju.call(this)}function ns(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode){n.setSelectedCellText(t,e);var o=n.selector,i=o.ri,a=o.ci;"finished"===e?r.render():this.trigger("cell-edited",t,i,a)}}function rs(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Wu.call(this),Fu.call(this))}function os(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Vu.call(this):Wu.call(this);else if("clearformat"===t)rs.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Yu.call(this);else if("freeze"===t)if(e){var r=n.selector,o=r.ri,i=r.ci;this.freeze(o,i)}else this.freeze(0,0);else n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||Ku.call(this),Fu.call(this)}function is(t,e,n,r){this.data.setAutoFilter(t,e,n,r),Fu.call(this)}function as(){var t,e,n,r,o,i,a=this,l=this.selector,c=this.overlayerEl,u=this.rowResizer,s=this.colResizer,f=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,d=this.contextMenu,y=this.toolbar,b=this.modalValidation,v=this.sortFilter;c.on("mousemove",(function(t){Du.call(a,t)})).on("mousedown",(function(t){p.clear(),d.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)||Zu.call(a,t),d.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?Ku.call(a):Zu.call(a,t)})).on("mousewheel.stop",(function(t){zu.call(a,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&u.hide()})),l.inputChange=function(t){ns.call(a,t,"input"),Ku.call(a)},t=c.el,n=(e={move:function(t,e){Mu.call(a,t,e)}}).move,r=e.end,o=0,i=0,ne(t,"touchstart",(function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;o=n,i=r})),ne(t,"touchmove",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,l=r-o,c=a-i;(Math.abs(l)>10||Math.abs(c)>10)&&(le(l,c,t,n),o=r,i=a),t.preventDefault()}})),ne(t,"touchend",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;le(n-o,a-i,t,r)}})),y.change=function(t,e){return os.call(a,t,e)},v.ok=function(t,e,n,r){return is.call(a,t,e,n,r)},u.finishedFn=function(t,e){ts.call(a,t,e)},s.finishedFn=function(t,e){es.call(a,t,e)},u.unhideFn=function(t){Lu.call(a,"row",t)},s.unhideFn=function(t){Lu.call(a,"col",t)},f.moveFn=function(t,e){Gu.call(a,t,e)},h.moveFn=function(t,e){Qu.call(a,t,e)},p.change=function(t,e){ns.call(a,e,t)},b.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=a.data).addValidation.apply(e,r)}else a.data.removeValidation()},d.itemClick=function(t){"validation"===t?b.setValue(a.data.getSelectedValidation()):"copy"===t?Vu.call(a):"cut"===t?Uu.call(a):"paste"===t?$u.call(a,"all"):"paste-value"===t?$u.call(a,"text"):"paste-format"===t?$u.call(a,"format"):"hide"===t?qu.call(a):rs.call(a,t)},ne(window,"resize",(function(){a.reload()})),ne(window,"click",(function(t){a.focusing=c.contains(t.target)})),ne(window,"paste",(function(t){a.focusing&&($u.call(a,"all",t),t.preventDefault())})),ne(window,"copy",(function(t){a.focusing&&(Vu.call(a,t),t.preventDefault())})),ne(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,o=t.shiftKey,i=t.metaKey;if(r||i)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:case 86:default:break;case 88:Uu.call(a),t.preventDefault();break;case 85:y.trigger("underline"),t.preventDefault();break;case 37:Iu.call(a,o,"row-first"),t.preventDefault();break;case 38:Iu.call(a,o,"col-first"),t.preventDefault();break;case 39:Iu.call(a,o,"row-last"),t.preventDefault();break;case 40:Iu.call(a,o,"col-last"),t.preventDefault();break;case 32:Ru.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:y.trigger("bold");break;case 73:y.trigger("italic")}else{switch(e){case 32:o&&Ru.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:d.hide(),Wu.call(a);break;case 37:Iu.call(a,o,"left"),t.preventDefault();break;case 38:Iu.call(a,o,"up"),t.preventDefault();break;case 39:Iu.call(a,o,"right"),t.preventDefault();break;case 40:Iu.call(a,o,"down"),t.preventDefault();break;case 9:p.clear(),Iu.call(a,!1,o?"left":"right"),t.preventDefault();break;case 13:p.clear(),Iu.call(a,!1,o?"up":"down"),t.preventDefault();break;case 8:rs.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===n?(rs.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(ns.call(a,t.key,"input"),Ku.call(a)):113===e&&Ku.call(a)}}}))}var ls=function(){return t=function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=function(){var t=new Map;function e(e,n){var r;return t.has(e)&&(r=t.get(e),Array.isArray(r)&&r.push(n)||!1)||t.set(e,[].concat(n))}function n(e,n){var r,o;return t.has(e)&&(o=(r=t.get(e)).indexOf(n))>=0&&r.splice(o,1)&&0===t.get(e).length&&t.delete(e)}return{get current(){return t},on:e,once:function(t,r){var o=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];r.call.apply(r,[null].concat(i)),n(t,o)};return e(t,o)},fire:function(e,n){return t.has(e)&&function(){var r,o,i=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=te(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t.get(e));try{for(i.s();!(r=i.n()).done;){var a=r.value;a.call.apply(a,[null].concat(function(t){if(Array.isArray(t))return ee(t)}(o=n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||te(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}catch(t){i.e(t)}finally{i.f()}}()},removeListener:n,removeAllListeners:function(){t.clear()}}}();var o=n.settings,i=o.view,a=o.showToolbar,l=o.showContextmenu;this.el=c("div","".concat(ce,"-sheet")),this.toolbar=new $c(n,i.width,!a),this.print=new Wr(n),e.children(this.toolbar.el,this.el,this.print.el),this.data=n,this.tableEl=c("canvas","".concat(ce,"-table")),this.rowResizer=new he(!1,n.rows.height),this.colResizer=new he(!0,n.cols.minWidth),this.verticalScrollbar=new be(!0),this.horizontalScrollbar=new be(!1),this.editor=new jn(or,(function(){return r.getTableOffset()}),n.rows.height),this.modalValidation=new yu,this.contextMenu=new Zr((function(){return r.getRect()}),!l),this.selector=new Be(n),this.overlayerCEl=c("div","".concat(ce,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=c("div","".concat(ce,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Ou,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Cr(this.tableEl.el,n),as.call(this),Fu.call(this),Ru.call(this,!1,0,0)},e=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.fire(t,r)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,Bu.call(this),Hu.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Fu.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Fu.call(this),this}},{key:"undo",value:function(){this.data.undo(),Fu.call(this)}},{key:"redo",value:function(){this.data.redo(),Fu.call(this)}},{key:"reload",value:function(){return Fu.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),o=r.width,i=r.height;return{width:o-n.indexWidth,height:i-e.height,left:n.indexWidth,top:e.height}}}],e&&Pu(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function cs(t){return cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cs(t)}function us(t){return function(t){if(Array.isArray(t))return fs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ss(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(t,e){if(t){if("string"==typeof t)return fs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fs(t,e):void 0}}function fs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function hs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ps(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ys(r.key),r)}}function ds(t,e,n){return e&&ps(t.prototype,e),n&&ps(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ys(t){var e=function(t){if("object"!=cs(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=cs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cs(e)?e:e+""}function bs(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(bs=function(){return!!t})()}function vs(t){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vs(t)}function ms(t,e){return ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ms(t,e)}var gs=function(t){function e(t){var n;return hs(this,e),(n=function(t,e,n){return e=vs(e),function(t,e){if(e&&("object"==cs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,bs()?Reflect.construct(e,n||[],vs(t).constructor):e.apply(t,n))}(this,e,[new Qe("ellipsis"),"auto",!1,"top-left"])).contentClick=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ms(t,e)}(e,t),ds(e,[{key:"reset",value:function(t){var e=this,n=t.map((function(t,n){return c("div","".concat(ce,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(n),e.hide()})).child(t)}));this.setContentChildren.apply(this,us(n))}},{key:"setTitle",value:function(){}}])}(yo),ws=[{key:"delete",title:xt("contextmenu.deleteSheet")}];function xs(t){var e=this;return c("div","".concat(ce,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function Ss(){var t=this;return ws.map((function(e){return xs.call(t,e)}))}var Os=function(){return ds((function t(){var e;hs(this,t),this.el=(e=c("div","".concat(ce,"-contextmenu")).css("width","160px")).children.apply(e,us(Ss.call(this))).hide(),this.itemClick=function(){}}),[{key:"hide",value:function(){var t=this.el;t.hide(),oe(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),ie(e)}}])}(),ks=function(){return ds((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};hs(this,t),this.swapFunc=r,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new gs((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new Os,this.contextMenu.itemClick=o,this.el=c("div","".concat(ce,"-bottombar")).children(this.contextMenu.el,this.menuEl=c("ul","".concat(ce,"-menu")).child(c("li","").children(new Qe("add").on("click",(function(){n()})),c("span","").child(this.moreEl))))}),[{key:"addItem",value:function(t,e,n){var r=this;this.dataNames.push(t);var o=c("li",e?"active":"").child(t);o.on("click",(function(){r.clickSwap2(o)})).on("contextmenu",(function(t){if("read"!==n.mode){var e=t.target,i=e.offsetLeft,a=e.offsetHeight;r.contextMenu.setOffset({left:i,bottom:a+1}),r.deleteEl=o}})).on("dblclick",(function(){if("read"!==n.mode){var t=o.html(),e=new Qc("auto","");e.val(t),e.input.on("blur",(function(e){var n=e.target.value,o=r.dataNames.findIndex((function(e){return e===t}));r.renameItem(o,n)})),o.html("").child(e.el),e.focus()}})),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t,e,n=this.activeEl,r=this.deleteEl;if(this.items.length>1){var o=this.items.findIndex((function(t){return t===r}));if(this.items.splice(o,1),this.dataNames.splice(o,1),this.menuEl.removeChild(r.el),this.moreEl.reset(this.dataNames),n===r){var i=(t=this.items,e=1,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||ss(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return this.activeEl=i,this.activeEl.toggle(),[o,0]}return[o,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}])}(),js=n(72),Ps=n.n(js),Es=n(825),Ts=n.n(Es),Cs=n(659),_s=n.n(Cs),As=n(56),Rs=n.n(As),Is=n(540),Ds=n.n(Is),zs=n(113),Ms=n.n(zs),Bs=n(420),Hs={};function Ns(t){return Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(t)}function Fs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ws(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Vs(t,e,n){return(e=$s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$s(r.key),r)}}function $s(t){var e=function(t){if("object"!=Ns(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ns(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ns(e)?e:e+""}Hs.styleTagTransform=Ms(),Hs.setAttributes=Rs(),Hs.insert=_s().bind(null,"head"),Hs.domAPI=Ts(),Hs.insertStyleElement=Ds(),Ps()(Bs.A,Hs),Bs.A&&Bs.A.locals&&Bs.A.locals;var qs=function(){return function(t,e,n){return e&&Us(t.prototype,e),n&&Us(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=e;this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ws(Object(n),!0).forEach((function(e){Vs(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ws(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({showBottomBar:!0},r),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(o=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new ks((function(){if("read"!==n.options.mode){var t=n.addSheet();n.sheet.resetData(t)}}),(function(t){var e=n.datas[t];n.sheet.resetData(e)}),(function(){n.deleteSheet()}),(function(t,e){n.datas[t].name=e,n.sheet.trigger("change")})):null,this.data=this.addSheet();var i=c("div","".concat(ce)).on("contextmenu",(function(t){return t.preventDefault()}));o.appendChild(i.el),this.sheet=new ls(i,this.data),null!==this.bottombar&&i.child(this.bottombar.el)}),[{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),o=new Qt(r,this.options);return o.change=function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];(t=e.sheet).trigger.apply(t,["change"].concat(r))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(r,n,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=(r=this.bottombar.deleteItem(),o=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(r,o)||function(t,e){if(t){if("string"==typeof t)return Fs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fs(t,e):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e=t[0],n=t[1];e>=0&&(this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n]),this.sheet.trigger("change"))}var r,o}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],o=this.addSheet(r.name,0===n);o.setData(r),0===n&&this.sheet.resetData(o)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}],[{key:"locale",value:function(t,e){St(t,e)}}])}();window&&(window.x_spreadsheet=function(t){return new qs(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},window.x_spreadsheet.locale=function(t,e){return St(t,e)})})();